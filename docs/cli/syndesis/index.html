<!DOCTYPE html><html lang="en-gb"><head><meta name="generator" content="Hugo 0.62.2"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Syndesis CLI</title><script type="application/javascript">var doNotTrack=!1;doNotTrack||(!function(a,e,t,n,o,c,g){a.GoogleAnalyticsObject=o,a.ga=a.ga||function(){(a.ga.q=a.ga.q||[]).push(arguments)},a.ga.l=1*new Date,c=e.createElement(t),g=e.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",g.parentNode.insertBefore(c,g)}(window,document,"script",0,"ga"),ga("create","UA-98663114-1","auto"),ga("send","pageview"))</script><link rel="canonical" href="https://syndesis.io/docs/cli/syndesis/"><link rel="icon" type="image/png" href="https://syndesis.io/images/favicon.png"><meta name="generator" content="Hugo 0.62.2"><link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://syndesis.io/css/syndesis.css"></head><body class="docs"><div id="wrapper"><a href="https://github.com/syndesisio" class="github-corner hidden-md-down" aria-label="View source on Github" rel="nofollow" target="_blank"><svg width="74" height="74" viewBox="0 0 250 250" style="fill:#fff;z-index:2000;color:#0088ce;mix-blend-mode:screen;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7
        120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9
        125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6
        C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0
        C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1
        C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4
        C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9
        C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5
        C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9
        L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><nav class="navbar topnav fixed-top navbar-inverse bg-primary navbar-toggleable-md sps sps--abv"><button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-nav" aria-controls="top-nav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button> <a href="https://syndesis.io/" title="Syndesis - Open source integration platform"><svg id="artwork" xmlns="http://www.w3.org/2000/svg" width="190px" height="39.33px" viewBox="0 0 1300 300" preserveAspectRatio="xMidYMin slice"><defs><style>.cls-1{fill:#9adde8}.cls-2{fill:#49badc}.cls-3{fill:#fff}</style></defs><title>Syndesis - Open source integration platform</title><polygon class="cls-1" points="129.95 98.77 33.99 144.38 122.22 167.37 218.18 121.75 129.95 98.77"/><polygon class="cls-2" points="218.18 121.75 218.18 121.75 122.22 167.37 242.17 198.61 218.18 121.75"/><polygon class="cls-1" points="154.99 86.86 131 10 10 67.52 129.95 98.77 154.99 86.86"/><polygon class="cls-2" points="33.99 144.38 129.95 98.77 10 67.52 10 67.52 33.99 144.38"/><polygon class="cls-2" points="189.64 25.27 131 10 154.99 86.86 213.63 102.14 189.64 25.27"/><polygon class="cls-2" points="38.54 164 62.53 240.86 121.17 256.13 121.17 256.13 97.18 179.27 97.18 179.27 38.54 164"/><polygon class="cls-1" points="242.17 198.61 122.22 167.37 97.18 179.27 121.17 256.13 242.17 198.61"/><path class="cls-3" d="M358.91,210.23c-23.57,0-43.44-17.22-44.06-41.6H329.2c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.65-9.63,35.65-28.48,0-14.76-10.65-21.73-23.15-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.15,35.25H399.28c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C416.29,200.39,388.62,210.23,358.91,210.23Z"/><path class="cls-3" d="M484.32,143.22l-54.51-84h17l45.29,71.52L537.4,59.2h14.34l-54.1,83.61v64.34H484.32Z"/><path class="cls-3" d="M572.24,59.2H587.4L669,189.32h.41V59.2h13.32v148h-16.8L586,79.28h-.41V207.15H572.24Z"/><path class="cls-3" d="M760,59.2c48.56,0,76.23,25,76.23,74s-27.67,74-76.23,74H720V59.2Zm3.27,135.66c41.6,0,58.61-24.39,58.61-61.69,0-43.64-25.61-62.91-67.62-61.68h-20.9V194.86Z"/><path class="cls-3" d="M870.19,207.15V59.2H958.1V71.49H883.51v53.08h71.73v12.29H883.51v58h77.67v12.29Z"/><path class="cls-3" d="M1030.44,210.23c-23.56,0-43.44-17.22-44.05-41.6h14.34c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.66-9.63,35.66-28.48,0-14.76-10.66-21.73-23.16-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.16,35.25h-14.35c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C1087.82,200.39,1060.16,210.23,1030.44,210.23Z"/><path class="cls-3" d="M1121.63,207.15V58.58H1135V207.15Z"/><path class="cls-3" d="M1212.62,210.23c-23.56,0-43.44-17.22-44.06-41.6h14.35c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.66-9.63,35.66-28.48,0-14.76-10.66-21.73-23.16-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.16,35.25H1253c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C1270,200.39,1242.34,210.23,1212.62,210.23Z"/></svg></a><div class="collapse navbar-collapse" id="top-nav"><ul class="navbar-nav ml-auto mt-2 mt-md-0 mr-lg-4"><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/quickstart">quickstart</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/docs">docs</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/blog">blog</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/faq">faq</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/community">community</a></li></ul></div></nav><div id="main" class="d-flex flex-row"><div id="sidebar" class="sidenav no-sidebar"><div class="menu"><ul class="sidebar-menu"><li class="nav-button hidden-lg-up"><button type="button" class="btn btn-primary btn-sm" data-toggle="offcanvas" data-target="#sidebar">Hide nav</button></li><li class=""><a href="https://syndesis.io/docs/development_quickstart/" class="menu__title">&nbsp;Development QuickStart</a></li><span class="menu__title--collapse" data-depth="0"><i class="fas fa-cubes"></i> Architecture <span class="menu__title--icon right"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="currentColor" d="M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z"/></svg></span></span><ul class="menu__list" data-data="/architecture/" data-link="https://syndesis.io/docs/cli/syndesis/"><li><a href="https://syndesis.io/docs/architecture/syndesis/" class="menu__title" data-depth="0">&nbsp;Syndesis Architecture</a></li><li><a href="https://syndesis.io/docs/architecture/maven_architecture/" class="menu__title" data-depth="0">&nbsp;Maven Architecture</a></li></ul><span class="menu__title--collapse active" data-depth="0"><i class="fas fa-keyboard"></i> CLI <span class="menu__title--icon down"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="currentColor" d="M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z"/></svg></span></span><ul class="menu__list active" data-data="/cli/" data-link="https://syndesis.io/docs/cli/syndesis/"><li><a href="https://syndesis.io/docs/cli/syndesis/" class="menu__title active" data-depth="0">&nbsp;Syndesis CLI</a></li><li><a href="https://syndesis.io/docs/cli/day_to_day/" class="menu__title" data-depth="0">&nbsp;Day to Day</a></li><li><a href="https://syndesis.io/docs/cli/troubleshooting/" class="menu__title" data-depth="0">&nbsp;Troubleshooting</a></li></ul><span class="menu__title--collapse" data-depth="0"><i class="fas fa-window-restore"></i> Connectors <span class="menu__title--icon right"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="currentColor" d="M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z"/></svg></span></span><ul class="menu__list" data-data="/connectors/" data-link="https://syndesis.io/docs/cli/syndesis/"><li><a href="https://syndesis.io/docs/connectors/whatis/" class="menu__title" data-depth="0">&nbsp;What is a Connector</a></li><li><a href="https://syndesis.io/docs/connectors/create/" class="menu__title" data-depth="0">&nbsp;Create a Connector</a></li><li><a href="https://syndesis.io/docs/connectors/connector-schema/" class="menu__title" data-depth="0">&nbsp;Connector Schema</a></li><li><a href="https://syndesis.io/docs/connectors/datashapes/" class="menu__title" data-depth="0">&nbsp;Data Shapes</a></li><li><a href="https://syndesis.io/docs/connectors/autodiscovery/" class="menu__title" data-depth="0">&nbsp;Connection Autodiscovery</a></li></ul><span class="menu__title--collapse" data-depth="0"><i class="fas fa-window-restore"></i> Extensions <span class="menu__title--icon right"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="currentColor" d="M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z"/></svg></span></span><ul class="menu__list" data-data="/extensions/" data-link="https://syndesis.io/docs/cli/syndesis/"><li><a href="https://syndesis.io/docs/extensions/whatis/" class="menu__title" data-depth="0">&nbsp;What is an Extension</a></li><li><a href="https://syndesis.io/docs/extensions/create/" class="menu__title" data-depth="0">&nbsp;Create an Extension</a></li></ul><span class="menu__title--collapse" data-depth="0"><i class="fas fa-user-friends"></i> Contributing <span class="menu__title--icon right"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="currentColor" d="M9.29 15.88L13.17 12 9.29 8.12c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l4.59 4.59c.39.39.39 1.02 0 1.41L10.7 17.3c-.39.39-1.02.39-1.41 0-.38-.39-.39-1.03 0-1.42z"/></svg></span></span><ul class="menu__list" data-data="/contributing/" data-link="https://syndesis.io/docs/cli/syndesis/"><li><a href="https://syndesis.io/docs/contributing/how/" class="menu__title" data-depth="0">&nbsp;How to Contribute</a></li><li><a href="https://syndesis.io/docs/contributing/categorization/" class="menu__title" data-depth="0">&nbsp;Categorization</a></li><li><a href="https://syndesis.io/docs/contributing/engineering_guidelines/" class="menu__title" data-depth="0">&nbsp;Engineering Guidelines</a></li></ul><li><a href="https://github.com/syndesisio/syndesis/issues/" target="blank"><i class="fas fa-life-ring"></i>&nbsp;<span>Issues & Help</span></a></li><li><a href="https://github.com/syndesisio/syndesis.io/edit/master/content/docs/cli/syndesis.md" target="blank"><i class="fas fa-edit"></i>&nbsp;Edit this Page</a></li></ul></div></div><div class="main-content"><div itemscope class="doc"><meta itemprop="name" content="Syndesis CLI"><meta itemprop="description" content="Buildtool &ldquo;syndesis&rdquo; Syndesis uses a single tool for controlling various aspects of the build and developer related tasks. This script can be found in $SYNDESIS_DIR/tools/bin and is called syndesis. It requires bash and can be used on any Unix or macOS.
To have this script handy all the time it is recommended to either put this bin/ directory into the path or add a symlink from syndesis into a directory which is already on your execution path."><meta itemprop="wordCount" content="6461"><meta itemprop="keywords" content=""><div class="hero"><h1 itemprop="headline">Syndesis CLI</h1></div><div itemprop="docBody" class="docBody"><h2 id="buildtool-syndesis">Buildtool &ldquo;syndesis&rdquo;</h2><p>Syndesis uses a single tool for controlling various aspects of the build and developer related tasks. This script can be found in <code>$SYNDESIS_DIR/tools/bin</code> and is called <code>syndesis</code>. It requires bash and can be used on any Unix or macOS.</p><p>To have this script handy all the time it is recommended to either put this <code>bin/</code> directory into the path or add a symlink from <code>syndesis</code> into a directory which is already on your execution path.</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#998;font-style:italic"># Navigate to syndesis project directory</span>
$ <span style="color:#0086b3">cd</span> <span style="color:teal">$SYNDESIS_DIR</span>

<span style="color:#998;font-style:italic"># Set path to include Syndesis&#39; tool directory</span>
$ <span style="color:#0086b3">export</span> <span style="color:teal">PATH</span><span style="color:#000;font-weight:700">=</span><span style="color:#d14">${</span><span style="color:teal">PATH</span><span style="color:#d14">}</span>:<span style="color:#000;font-weight:700">$(</span><span style="color:#0086b3">pwd</span><span style="color:#000;font-weight:700">)</span>/tools/bin

<span style="color:#998;font-style:italic"># Alternatively, set a symbolic link to &#34;syndesis&#34;</span>
$ ln -s <span style="color:#000;font-weight:700">$(</span><span style="color:#0086b3">pwd</span><span style="color:#000;font-weight:700">)</span>/tools/bin/syndesis /usr/local/bin</code></pre></div><p>The script can be used for various tasks which are selected by a so-called command_ which is the first argument to the script.</p><p>Just type <code>syndesis -h</code> to get an overview of the commands available:</p><h3 id="usage-message">Usage Message</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Usage: syndesis &lt;command&gt; [... options ...]

with the following commands

   build             Build Syndesis
   completion        Shell completion
   crc               Initialize and manage a developer environment using OCP4 CodeReady Containers
   dev               Syndesis developer tools
   install           Install Syndesis to a connected OpenShift cluster
   integration-test  Run integration tests
   kamel             Tools for developing integrations using Camel K
   minishift         Initialize and manage a Minishift developer environment
   release           Perform a release
   system-test       Run system tests
   ui                Syndesis UI tasks

&#34;build&#34; is the default command if no command is specified.</code></pre></div><p>Every sub command also offers usage information accessible using <code>syndesis subcommand --help</code>.</p><p>There are a handful of global options which can be used:</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><code>--help</code></td><td><code>-h</code></td><td>Print usage information. If a command is given print out commands specific options.</td></tr><tr><td><code>--rebase</code></td><td><code>-r</code></td><td>Rebase your project directory before building to integrate upstream changes to your local repository. See <a href="#rebase-to-upstream">below</a> for details how this works.</td></tr><tr><td><code>--verbose</code></td><td>&nbsp;</td><td>Set verbose mode, which is useful mostly only for debugging the script itself.</td></tr></tbody></table><h3 id="rebase-to-upstream">Rebase to Upstream</h3><p>To easily rebase on changes which have been merged upstream to master, you can use the option <code>--rebase</code> (short: <code>-r</code>).</p><p>This command assumes that you have forked the Syndesis GitHub repositories and you have &ldquo;origin&rdquo; and &ldquo;upstream&rdquo; remotes like</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git remote -v
origin    git@github.com:rhuss/syndesis.git (fetch)
origin    git@github.com:rhuss/syndesis.git (push)
upstream  https://github.com/syndesisio/syndesis (fetch)
upstream  https://github.com/syndesisio/syndesis (push)</code></pre></div><p>Use the following command to add the upstream syndesis repository: <code>git remote add upstream git@github.com:syndesisio/syndesis.git</code></p><p>With this in place, a <code>--rebase</code> performs the following steps:</p><ul><li>Refresh upstream remote: <code>git fetch upstream master</code></li><li>Try a <code>git rebase upstream/master</code> which rebases your current local working branch.</li><li>If this fails because you have uncommitted work:<ul><li>A <code>git stash</code> is performed</li><li>The rebase is retried and should succeed</li><li><code>git stash pop</code> brings back your changes. Stashing can fail with conflicts which you would have to resolve on your own.</li></ul></li></ul><h3 id="development-modes">Development Modes</h3><p>The Syndesis application consists of a set of Docker images OpenShift resources descriptors for installing Syndesis. For development, <a href="https://www.openshift.org/minishift/" rel="noreferrer" target="_blank">minishift</a> or <a href="https://code-ready.github.io/crc/" rel="noreferrer" target="_blank">CodeReady Containers</a> are used, and most of the commands assume that you have either <code>minishift</code> or <code>crc</code> installed locally and executable directly from your path.</p><p>Minishift can be downloaded and installed from <a href="https://github.com/minishift/minishift/releases" rel="noreferrer" target="_blank">https://github.com/minishift/minishift/releases</a>.</p><p>Installation instructions for CodeReady Containers can be found in the <a href="https://code-ready.github.io/crc/#installation_gsg" rel="noreferrer" target="_blank">project&rsquo;s documentation</a>.</p><p>For development OpenShift S2I builds and image streams are used. This mode works also when running with a real OpenShift cluster and is not restricted to Minishift or CodeReady Containers usage. The advantage is that a build automatically triggers a redeployment, so you don&rsquo;t have to restart any pods manually.</p><h3 id="commands">Commands</h3><p>All other options are specific to each command. You get a list of those options with <code>syndesis &lt;cmd&gt; -h</code>. These options are described in detail in the next sections.</p><p>The following commands are highlighted in this document:</p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>build</td><td>Used for building Syndesis and its various modules</td></tr><tr><td>ui</td><td>Start the UI for local development</td></tr><tr><td>crc</td><td>Start and install Syndesis on OCP4 CodeReady Containers</td></tr><tr><td>minishift</td><td>Start and install Syndesis on Minishift</td></tr><tr><td>install</td><td>Install Syndesis in a running cluster (other than Minishift or CodeReady Containers)</td></tr><tr><td>dev</td><td>Utility commands useful during development</td></tr><tr><td>release</td><td>Release Syndesis</td></tr></tbody></table><p>If no command is given, <code>build</code> is the default. Remember a command must be the first argument, but there are additional possibilities to specify commands:</p><ul><li>You can use the form <code>--command</code> anywhere as an option, too. E.g. using <code>--minishift</code> is the same as specifying &ldquo;minishift&rdquo; as the first argument.</li><li>A <code>--mode command</code> can be used, too (e.g. <code>--mode ui</code>)</li></ul><p>The next sections describe the commands in detail. To add a new command, just drop a script file into <code>$SYNDESIS_DIR/tools/bin/commands</code> directory with following structure:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-weight:700;font-style:italic">#!/bin/bash
</span><span style="color:#999;font-weight:700;font-style:italic"></span>
yourscriptname::description<span style="color:#000;font-weight:700">(</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000;font-weight:700">{</span>
    <span style="color:#0086b3">echo</span> <span style="color:#d14">&#34;Describe the command&#34;</span>
<span style="color:#000;font-weight:700">}</span>

yourscriptname::usage<span style="color:#000;font-weight:700">(</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000;font-weight:700">{</span>
    cat <span style="color:#d14">&lt;&lt;EOT
</span><span style="color:#d14">    Describe the usage of the command
</span><span style="color:#d14">EOT</span>
<span style="color:#000;font-weight:700">}</span>

yourscriptname::run<span style="color:#000;font-weight:700">(</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000;font-weight:700">{</span>
    Do your stuff
<span style="color:#000;font-weight:700">}</span></code></pre></div><h2 id="syndesis-build">syndesis build</h2><p>The primary goal of <code>syndesis build</code> is to build Syndesis.</p><p>It is mainly a wrapper around Maven, Yarn and Go but adds some convenience functionality for common developer workflows.</p><h3 id="modules">Modules</h3><p>A plain <code>build</code> command without any options performs a plain <code>mvn install</code> for all Java and UI modules. Plus it also builds the infrastructure operator via Go (see <a href="#infrastructure-operator">syndesis-build-operator</a> for details)</p><p>This compiles all Java and Javascript artifacts and also runs all tests and code checks for the application modules.</p><p>You restrict the build to certain modules, which are divided into two categories: <em>application modules</em> which are the modules building up Syndesis. And <em>infrastructure modules</em> which help in managing the application itself.</p><p>You can individually select specific modules by using the <code>--module</code> (short: <code>-m</code>) option with a comma-separated list of modules, but there are also option to combine modules.</p><p>For example to build just the UI you can run:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ syndesis build -m ui</code></pre></div><p>The following modules are available:</p><table><thead><tr><th>Module</th><th>Description</th><th><code>--all-images</code></th><th><code>--backend</code></th><th><code>--app-images</code></th><th><code>--infra-images</code></th></tr></thead><tbody><tr><td><strong>server</strong></td><td>Main backend providing a REST API for the user interface</td><td>✔︎</td><td>✔︎</td><td>✔︎</td><td></td></tr><tr><td><strong>ui</strong></td><td>The SPA user interface application</td><td>✔︎</td><td></td><td>✔︎</td><td></td></tr><tr><td><strong>meta</strong></td><td>Meta data and verifier used for verifying connections and providing connector metadata</td><td>✔︎</td><td>✔︎</td><td>✔︎</td><td></td></tr><tr><td><strong>connector</strong></td><td>All connectors used by Syndesis out of the box</td><td></td><td>✔︎</td><td></td><td></td></tr><tr><td><strong>integration</strong></td><td>Support libraries for running integrations</td><td></td><td>✔︎</td><td></td><td></td></tr><tr><td><strong>extension</strong></td><td>Tools for developing and running Syndesis custom extensions</td><td></td><td>✔︎</td><td></td><td></td></tr><tr><td><strong>common</strong></td><td>Common modules containing common code</td><td></td><td>✔︎</td><td></td><td></td></tr><tr><td><strong>s2i</strong></td><td>S2I base image used for building the runtime images</td><td>✔︎</td><td></td><td>✔︎</td><td></td></tr><tr><td><strong>operator</strong></td><td>Infrastructure operator for managing the application</td><td>✔︎</td><td></td><td></td><td>✔︎</td></tr></tbody></table><p>All option ending with <code>-images</code> will also build the corresponding Docker image.</p><p>In addition to using top level modules that combine to a set of submodules you can also specify a very specific submodule using its groupId and/or artifactId. For instance the module name for the SQL connector module would be <code>io.syndesis.connector:connector-sql</code> or simply <code>:connector-sql</code>. In case you skip the groupId the leading colon in the module name is very important because this identifies the module to be a submodule rather that a top level module.</p><p>When you build individual modules you you can provide the option <code>--image</code> (short: <code>-i</code>) to create also the Docker image in the build, when the module is associated with a Docker image.</p><p>By default images are build via S2I against a running Minishift. This is the recommended way for developing as this automatically will trigger a redeployment after the build. However, for certain scenarios like when used in a CI system or when doing the release, the image creation can be done against are Docker daemon when the <code>--docker</code> is given. For this to work you must have access to Docker daemon, which you can verify with <code>docker ps</code>.</p><p>When the option <code>--dependencies</code> (short: <code>-d</code>) is given in addition to <code>--modules</code>, also all Maven modules which the specified modules depend on are build, too.</p><h3 id="tuning">Tuning</h3><p>By default, all checks like license or code quality checks are performed. Also, all unit and local integration tests are run. A full build eats up quite some time, but you should always run at full blast before submitting a pull request.</p><p>However, to speed up the turnaround, several speed-up options are available. The following table shows these options, and also how long a full clean build over all modules takes: (but without building images)</p><table><thead><tr><th>Option</th><th>Description</th><th>Time</th></tr></thead><tbody><tr><td><em>none</em></td><td>Default mode with all checks and tests</td><td></td></tr><tr><td><code>--skip-tests</code></td><td>Skip all unit and local integration tests</td><td></td></tr><tr><td><code>--skip-checks</code></td><td>Skip sanity checks like for correct license headers and</td><td></td></tr><tr><td><code>--flash</code></td><td>Fastest mode with skipping all checks and tests and with even some other aggressive optimizations</td><td></td></tr></tbody></table><h3 id="maven-mirror">Maven mirror</h3><p>At build time the dependencies are downloaded from maven central repository, it is recommended to install a local maven repository manager on your openshift to also serve as repository for the <code>s2i</code> builds running in openshift. If you want to have the local maven repository automatically created, you can specify the <code>--maven-mirror</code> parameter when installing minishift.</p><p>To build syndesis modules with the local maven mirror, use the <code>--maven-mirror</code> parameter, example:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ syndesis build -m server -d -i -f --maven-mirror</code></pre></div><h3 id="syndesis-operator">Syndesis Operator</h3><p><code>syndesis build</code> can also build the infrastructure operator, which is a golang program.</p><p>You can build the operator by running <code>syndesis build -m operator</code> or as part of a module collection like <code>--all-images</code> or <code>--infra-images</code></p><p>There are three modes, how the operator can be created:</p><ul><li>Running you go compiler locally</li><li>Compiling in a local Docker daemon which allows volume mounts with the localhost</li><li>Compiling in Minishift Docker daemon, which was made accessible via <code>eval $(minishift docker-env)</code></li></ul><p>See below for the details.</p><p><strong>Load dependencies</strong></p><p>In any case, before you compile first you should use the option <code>--ensure</code> (short: <code>-e</code>) to setup the dependency tree. This will download all source dependency and cache them locally. To get rid of this cache, use the option <code>--clean-cache</code>.</p><p>If you compile for the first time, then <code>--ensure</code> will be added automatically.</p><p><strong>Compiling locally</strong></p><p>This is the fastest way for compiling the operator. Use the option <code>--local</code> (short: <code>-l</code>) for selecting the local compile mode.</p><p>It is also the recommended way when you are working on the operator. You project setup needs to fit however: The main project directory must be reachable as <code>$GOPATH/src/github.com/syndesisio/syndesis</code>. You can either move your project directory to this location or work with a symlink:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#0086b3">cd</span> ~/Development/syndesis
$ mkdir -p <span style="color:teal">$GOPATH</span>/src/github.com/syndesisio
$ <span style="color:#0086b3">cd</span> ..
$ mv syndesis <span style="color:teal">$GOPATH</span>/src/github.com/syndesisio/
$ ln -s <span style="color:teal">$GOPATH</span>/src/github.com/syndesisio/ syndesis</code></pre></div><p>By default this compiles into for your native architecture (amd64, darwin). When you use this mode with <code>--image</code> (short: <code>-i</code>) on macOS then go will be used as cross compiler so that the generated bimary can be used in a Linux image.</p><p><strong>Compiling with a local Docker daemon</strong></p><p>This is the default mode and is used also when doing the release. It use a builder image <code>operator-builder</code> which is created from the embedded Dockerfile in the <code>install/operator/.lib.sh</code> script.</p><p>For this mode to work your Docker daemon must support volume mounts to the system from where you are calling <code>syndesis</code>. This is the case on Linux for locally installed Docker daemon and for Mac with <em>Docker for Mac</em>. It is <strong>not</strong> the case for Minishift which runs in a disconnected VM. But see below how you still can use Minishift for building.</p><p><code>go build</code> with <code>-mod=vendor</code> will be run from this an ad-hoc container image (<code>operator-builder</code>), with your local directory mounted into the container so that the fetched dependencies can be cached in the local directories <code>vendor</code> so that the can be reused for the next run. Also the binary will be stored in your local directory, but this will alway be a Linux (<code>amd64</code>) binary.</p><h3 id="examples">Examples</h3><p>Some common usage examples for <code>syndesis build</code> are</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#998;font-style:italic"># Build all images (app and infrastructure) with S2I</span>
$ syndesis build --all-images

<span style="color:#998;font-style:italic"># Create all application images and re-deploy Syndesis in the</span>
<span style="color:#998;font-style:italic"># Openshift cluster, but do it as fast as possible. Don&#39;t build</span>
<span style="color:#998;font-style:italic"># any golang code</span>
$ syndesis build --app-images --flash

<span style="color:#998;font-style:italic"># Create the infrastructure operator by running go locally</span>
<span style="color:#998;font-style:italic"># and calling dep ensure before</span>
$ syndesis build -m operator --local --ensure

<span style="color:#998;font-style:italic"># Use a Camel snapshot for a clean build, build all modules</span>
$ syndesis build --clean --camel-snapshot 2.21.0-SNAPSHOT</code></pre></div><h2 id="syndesis-ui">syndesis ui</h2><p><a href="https://yarnpkg.com" rel="noreferrer" target="_blank">Yarn</a> is the package manager required to work on the project. It&rsquo;s required to be installed, however the <code>syndesis ui</code> command can be used for day to day development tasks. For example:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#998;font-style:italic"># install all the dependendencies and build the project</span>
$ syndesis ui --install --build</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ syndesis ui --serve --minishift</code></pre></div><p>Runs the app in development mode using minishift. Automates running <code>yarn watch:app:minishift</code> and restores the console URL when you stop the development server. API calls will be proxied to the provided URL pointed by the <code>BACKEND</code> environment variable.</p><p>The proxy will require the session cookies to be able to properly work. The right cookies will be retrieved through an automated instance of Chromium, that will wait for the user to login. Once properly logged in - a condition recognized by the browser navigating back to the provided <code>BACKEND</code> URL - the session cookies will be extracted and the Chromium instance will be closed.</p><p>It&rsquo;s also possibile to enable the <em>chaos mode</em> setting the <code>CHAOS</code> env variable. In <em>chaos mode</em> API requests have a 50% chance to fail with an error 500.<br>This mode is useful to test the resilience of the app.</p><p><strong>IMPORTANT</strong></p><ul><li>the <code>BACKEND</code> URL should be the project URL as retrieved by Minishift/Openshift console.</li><li>doublecheck that the URL doesn&rsquo;t end with a &lsquo;/&rsquo;.</li><li>never close the automated Chromium browser manually; if it stays open probably after a successful login something went wrong and should be debugged.</li></ul><p>To run the tests use the <code>--run-tests</code> switch:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ syndesis ui --run-tests</code></pre></div><p>To run the test suite for a specific package you can pass the package name:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ yarn <span style="color:#0086b3">test</span> --scope @syndesis/package-name</code></pre></div><h2 id="syndesis-crc">syndesis crc</h2><p>With <code>syndesis crc</code> you can adequately manage a <a href="https://code-ready.github.io/crc/" rel="noreferrer" target="_blank">CodeReady Containers</a> installation for hosting Syndesis. This command is especially useful for a simple and self-contained development workflow.</p><p>When you&rsquo;re deciding between CodeReady Containers and Minishift for local OpenShift development environment take note that Minishift supports OpenShift up to 3.11, and CodeReady Containers supports OpenShift 4.x onward. CodeReady Containers also requires more resources to run.</p><p><code>syndesis crc</code> requires that you have a current crc binary in your path. You can download it directly from <a href="https://cloud.redhat.com/openshift/install/crc/installer-provisioned" rel="noreferrer" target="_blank">https://cloud.redhat.com</a>.</p><p><code>syndesis crc</code> will attempt to download the latest syndesis cli from the <a href="https://github.com/syndesisio/syndesis/releases/latest" rel="noreferrer" target="_blank">syndesis release page</a>. If this fails, you can try downloading the right binary for your distribution and placing it under <code>tools/bin/commands/binaries</code>.</p><h3 id="installing">Installing</h3><p>You can easily install Syndesis with the option <code>--install</code>. This option triggers the creation of all relevant OpenShift resources objects in the currently connected OpenShift project.</p><p>If you want to use a different project, then use <code>--project</code> (short: <code>-p</code>) to specify this project. We strongly recommend to use the project name <code>syndesis</code>, as the syndesis-operator uses it as default namespace.</p><div class="alert alert-info admonition" role="alert"><i class="fa warning"></i> Any existing project will be deleted first when specified with `--project`. This option is also an easy and quick way to recreate a Syndesis installation.</div><h3 id="resetting-codeready-containers">Resetting CodeReady Containers</h3><p>The quickest way to get a fresh Syndesis setup is to use <code>--project</code> which will install Syndesis into a clean, new project.</p><p>However, you can also recreate the whole CodeReady Containers installation with <code>--reset</code>. This will delete the CodeReady Containers VM (<code>crc delete</code>) and create a new one (<code>crc start</code>). It doesn&rsquo;t harm if the CodeReady Containers VM does not exist so that you can use <code>--reset</code> also on a fresh CodeReady Containers installation.</p><p>If you want to get a real clean installation use <code>--full-reset</code> which deletes the <code>~/.crc</code> directory which holds downloaded artifacts like the ISO image for the CodeReady Containers VM. Using <code>--full-reset</code> forces CodeReady Containers to re-download all those files.</p><p>There are several options which influence the re-creation of the VM:</p><table><thead><tr><th>Option</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>--memory</code></td><td>Memory to use for the CodeReady VM.</td><td>8 GB</td></tr><tr><td><code>--cpus</code></td><td>Number of CPUs used for the CodeReady VM.</td><td>4</td></tr><tr><td><code>--pull-secret-file</code></td><td>File holding the OCP4 pull secret</td><td></td></tr><tr><td><code>--vm-driver</code></td><td>Which virtual machine driver to use. For OS X this can be &lsquo;virtualbox&rsquo;</td><td></td></tr><tr><td><code>--bundle</code></td><td>Path to system bundle (required when using virtualbox vm-driver)</td><td>3.7.1</td></tr></tbody></table><h3 id="example">Example</h3><p>This short example performs the following actions: - Stops and deletes a running CodeReady Containers VM (if existent) - Removes <code>~/.crc</code> (if existent) - Install Syndesis in OpenShift modes (S2I builds &amp; image streams) in project <code>syndesis</code> - Opens Syndesis UI in the default browser</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#998;font-style:italic"># Complete fresh installation in project &#34;syndesis&#34;</span>
$ syndesis crc --full-reset --install --project syndesis

<span style="color:#998;font-style:italic"># Open Syndesis in default browser</span>
$ syndesis crc -o</code></pre></div><h2 id="syndesis-minishift">syndesis minishift</h2><p>With <code>syndesis minishift</code> you can adequately manage a <a href="https://www.openshift.org/minishift/" rel="noreferrer" target="_blank">minishift</a> installation for hosting Syndesis. This command is especially useful for a simple and self-contained development workflow.</p><p>When you&rsquo;re deciding between CodeReady Containers and Minishift for local OpenShift development environment take note that Minishift supports OpenShift up to 3.11, and CodeReady Containers supports OpenShift 4.x onward. CodeReady Containers also requires more resources to run.</p><p><code>syndesis minishift</code> requires that you have a current minishift in your path. You can download it directly from <a href="https://github.com/minishift/minishift/releases" rel="noreferrer" target="_blank">GitHub</a>.</p><h3 id="installing-1">Installing</h3><p>You can easily install Syndesis with the option <code>--install</code>. This option triggers the creation of all relevant OpenShift resources objects in the currently connected OpenShift project.</p><div class="alert alert-info admonition" role="alert"><i class="fa warning"></i> Any existing project will be deleted first when specified with `--project`. This option is also an easy and quick way to recreate a Syndesis installation.</div><h3 id="setting-a-maven-repository-manager">Setting a maven repository manager</h3><p>To reduce build time, it is recommended to setup a local maven repository manager, you can use the <code>--maven-mirror</code> parameter when installing minishift, this it will install <a href="https://www.sonatype.com/nexus-repository-oss" rel="noreferrer" target="_blank">Nexus</a> on the <code>nexus</code> OpenShift project.</p><h3 id="use-the-latest-syndesis-operator">Use the latest syndesis-operator</h3><p>The <code>syndesis-operator</code> is an important part of syndesis, to update image streams, manage syndesis components in openshift and much more. The <code>syndesis-operator</code> is placed in <code>$HOME/.syndesis/bin/syndesis-operator</code> and then later installed in openshift. Use the <code>-f</code> parameter to download the latest <code>syndesis-operator</code> release.</p><h3 id="installing-an-addon">Installing an addon</h3><p>There are some additional software packaged as <code>addon</code> such as: jaeger, data virtualization, camel-k, knative, etc. You can install syndesis with these addons by using the <code>--app-options</code> parameter, for example, to install syndesis with camel-k:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">syndesis minishift --install --project syndesis --app-options <span style="color:#d14">&#34; --addons camelk&#34;</span></code></pre></div><h3 id="resetting-minishift">Resetting Minishift</h3><p>The quickest way to get a fresh Syndesis setup is to use <code>--project</code> which will install Syndesis into a clean, new project.</p><p>However, you can also recreate the whole Minishift installation with <code>--reset</code>. This will delete the Minishift VM (<code>minishift delete</code>) and create a new one (<code>minishift start</code>). It doesn’t harm if the Minishift VM does not exist so that you can use <code>--reset</code> also on a fresh Minishift installation.</p><p>If you want to get a real clean installation use <code>--full-reset</code> which deletes the <code>~/.minishift</code> directory which holds downloaded artifacts like the ISO image for the Minishift VM. Using <code>--full-reset</code> forces Minishift to re-download all those files.</p><p>There are several options which influence the re-creation of the VM:</p><table><thead><tr><th>Option</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>--memory</code></td><td>Memory to use for the Minishift VM.</td><td>4 GB</td></tr><tr><td><code>--cpus</code></td><td>Number of CPUs used for the Minishift VM.</td><td>2</td></tr><tr><td><code>--disk-size</code></td><td>Disk space used for Minishift.</td><td>20 GB</td></tr><tr><td><code>--show-logs</code></td><td>Whether to show OpenShift logs during startup.</td><td>false</td></tr><tr><td><code>--vm-driver</code></td><td>Which virtual machine driver to use. For OS X this can be &lsquo;virtualbox&rsquo;, &lsquo;xhyve&rsquo; or &lsquo;vmwarefusion&rsquo; (if installed).</td><td></td></tr><tr><td><code>--openshift-version</code></td><td>OpenShift version to use</td><td>3.7.1</td></tr></tbody></table><h3 id="example-1">Example</h3><p>This short example performs the following actions:</p><ul><li>Stops and deletes a running Minishift VM (if existent)</li><li>Removes <code>~/.minishift</code> (if existent)</li><li>Install Syndesis in OpenShift modes (S2I builds &amp; image streams) in project <code>syndesis</code></li><li>Open Syndesis UI in the default browser</li><li><p>Install a Nexus maven repository manager in project <code>nexus</code></p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#998;font-style:italic"># Complete fresh installation in project &#34;syndesis&#34;</span>
$ syndesis minishift --full-reset --install --project syndesis --maven-mirror
<span style="color:#998;font-style:italic"># Open Syndesis in default browser</span>
$ syndesis minishift -o</code></pre></div></li></ul><h2 id="syndesis-dev">syndesis dev</h2><p>Dev commands are useful helpers for developing Syndesis</p><h3 id="debug-a-syndesis-component">Debug a syndesis component</h3><p>The <code>--debug</code> parameter enable port-forwarding of port 5005 from a specific pod (by default: &ldquo;server&rdquo;) to port 5005 on the localhost. You then can point your Java IDE to port 5005 on localhost for connecting for remote debugging. As argument to <code>--debug</code> &ldquo;server&rdquo;, &ldquo;meta&rdquo; and &ldquo;atlasmap&rdquo; can be used, which are our Java based services. For this to work the running pod must have been started with java debug agent enabled. You can enable it by setting the environment variabel JAVA_DEBUG=true to the deployment config, for example, the following command will enable java debug agent in the syndesis-server deployment config and the pod will be restarted.</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">oc <span style="color:#0086b3">set</span> env dc/syndesis-server <span style="color:teal">JAVA_DEBUG</span><span style="color:#000;font-weight:700">=</span>true</code></pre></div><h3 id="prune-old-stuff">Prune old stuff</h3><p>As the syndesis components are updated or integrations installed, after days or weeks many old syndesis components such as images, deployment configs, builds are stored and consumes space, it may slow the system down. So, you can free space by pruning old stuff from openshift by using the <code>--cleanup</code> parameter.</p><h3 id="install-maven-nexus-as-mirror">Install Maven Nexus as mirror</h3><p>The Syndesis S2i builds are loading dependencies from Maven central respectively Red Hat repositories. In order to improve performance and save some bits in transfer we recommend to use a Maven Nexus as mirror. This will decrease the amount of bits loaded from the internet every time a Syndesis integration is created.</p><p>You can add the Maven Nexus application in a separate project namespace to the OpenShift cluster by using:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ syndesis dev --install-maven-mirror</code></pre></div><p>This will create a new project on the cluster <code>nexus</code> and will install the latest Nexus Maven repository manager. You can use this Nexus instance when building and pushing new images to the Syndesis image streams using S2i.</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ syndesis -m s2i -i --maven-mirror http://nexus-nexus.apps-crc.testing/nexus/content/groups/public</code></pre></div><p>This will build a new base S2i image and use the Maven Nexus as mirror so all previously loaded dependencies will be loaded from the local Nexus instance instead of loading from the internet.</p><h2 id="syndesis-release">syndesis release</h2><p>Use <code>syndesis release</code> for performing a release of Syndesis. A Syndesis release consists of:</p><ul><li>Maven artifacts of the backend and runtime services</li><li>Docker images pushed to Docker Hub</li><li>Manifests created for operatorhub.io</li></ul><p>This chapter describes how you can efficiently perform a release and how to troubleshoot if something goes wrong. This documentation might also be interesting to you even when you do not perform a release on your own, as it might help you to understand how the various Syndesis artifacts fit together.</p><p>Even though the documenation mentions how to do this manually, we usually perform an automated release on our <a href="https://ci.fabric8.io/view/syndesis/" rel="noreferrer" target="_blank">CI server</a>. The CI server is set up with the necessary credentials and anyone with the permissions to run the release jobs can run a release.</p><p>A lot of output is produced during a release. If you are only interested to see the major steps only, then you can use <code>--log</code> to redirect the output to a specific log file. This log file will contain all output (and if you add <code>--verbose</code> you see even more output), but on the console you will only see the current step that is actually performed.</p><p><strong>Example</strong></p><p>An example run for a dry run for <code>1.3.1</code> release on the current branch look like:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">./tools/bin/syndesis release <span style="color:#d14">\ </span>          <span style="color:#099">1</span>
    --release-version 1.3.1 <span style="color:#d14">\ </span>           <span style="color:#099">2</span>
    --local-maven-repo /tmp/clean-repo <span style="color:#d14">\ </span><span style="color:#099">3</span>
    --log /tmp/build.log <span style="color:#d14">\ </span>              <span style="color:#099">4</span>
    --dry-run                            <span style="color:#099">5</span></code></pre></div><ol><li>Always run <code>syndesis</code> from the repo and branch you want to release.</li><li>The release version is mandatory and must be in the format <code>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</code>.</li><li>Use a clean local Maven repository to avoid side effects</li><li>Redirect the full output to <code>/tmp/build.log</code> but still print the main steps to the console.</li><li>Make only a dry run, without pushing any artifacts out nor checking in any changed files.</li></ol><h3 id="preparations">Preparations</h3><p>To perform a release, certain preconditions need to be given.</p><p>First of all, you need to have access to the various systems to which release artifacts are uploaded:</p><ul><li>You need to be logged in to <a href="https://hub.docker.com/" rel="noreferrer" target="_blank">Docker Hub</a> and your account needs to have write access to the <a href="https://hub.docker.com/u/syndesis/" rel="noreferrer" target="_blank">syndesis</a> Docker Hub organisation.</li><li>You have <code>gpg</code> to have installed and set up a gpg-agent for being able to sign Maven artifacts during deployment in a non-interactive mode.</li><li>You need to have access to the &ldquo;syndesis&rdquo; account on (<a href="https://oss.sonatype.org/" rel="noreferrer" target="_blank">oss.sonatype.org</a> for being able to publish Maven artifacts. This credential needs to be added to either your <code>~/.m2/settings.xml</code> or you can use an settings file with the <code>--settings-xml</code> option. The credential needs to be added to the server with the id <code>oss-sonatype-staging</code>.</li></ul><p>You have to perform the release from a locally checked out Syndesis repository, which can be either checkout from a branch like <code>1.2.x</code> for a patch release or directly from <code>master</code>. It is highly recommended to run the release directly from a freshly checked out directory:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#998;font-style:italic"># Go to a temporary directory</span>
$ <span style="color:#0086b3">cd</span> /tmp

<span style="color:#998;font-style:italic"># Clone repository afresh, but only use the last history entry (--depth=1)</span>
$ git clone --depth<span style="color:#000;font-weight:700">=</span><span style="color:#099">1</span> https://github.com/syndesisio/syndesis.git

<span style="color:#998;font-style:italic"># Jump into the directory</span>
$ <span style="color:#0086b3">cd</span> syndesis

<span style="color:#998;font-style:italic"># Switch to the target branch if needed (or stay on master)</span>
$ git fetch --depth <span style="color:#099">1</span> origin 1.2.x:1.2.x
$ git checkout 1.2.x

<span style="color:#998;font-style:italic"># Call Syndesis from the checked out clone</span>
$ ./tools/bin/syndesis release --release-version 1.2.8 .....

<span style="color:#998;font-style:italic"># Push to origin after a successful release.</span>
<span style="color:#998;font-style:italic"># This automatically done if --no-git-push is given</span>
$ git push 1.2.8
$ git push -f 1.2

<span style="color:#998;font-style:italic"># Remove the temporary clone again</span>
$ <span style="color:#0086b3">cd</span> ..
$ rm -rf syndesis</code></pre></div><p>Please note that you should always call <code>syndesis</code> out of the branch for which the release is for. If there is an issue due to bugs in the release script itself, please fix them on the branch with the usual developer process (i.e. opening a PR request). <code>syndesis release</code> must always work for the branch where this script is, too.</p><h3 id="release-steps">Release steps</h3><p>A release consist of several different steps, which can be grouped into two groups:</p><ul><li><strong>Build steps</strong> are performed to build the release and create the artifacts. Also during the build Maven artifacts are uploaded to the staging area for publishing to Maven central</li><li><strong>Persist steps</strong> are then used for releasing objects, pushing Docker images to Docker Hub, committing and tagging in Git (but only when the build steps have been performed successfully).</li></ul><p><strong>Build steps</strong></p><ul><li>Check whether the current local Git clone is <em>clean</em>, i.e. that is does not have any modified files. The script will abort if this is the case.</li><li>Update the versions of all <code>pom.xml</code> files below <code>app/</code> to the version given with <code>--release-version</code>. If no <code>--release-version</code> is given, then the script aborts.</li><li>Run an <code>mvn clean install</code> to verify that the build is not broken and all tests succeed.</li><li>Run an <code>mvn -Prelease clean deploy</code> to deploy all artifacts to a new staging repository on oss.sonatype.org, the platform for release artifacts on Maven central. The staging repository on this Sonatype Nexus is validated and closed.</li><li>If <code>--docker-user</code> and <code>--docker-password</code> is given, then a <code>docker login</code> is performed. Otherwise, it is assumed that the user is already logged in.</li><li>The Docker images are created with <code>mvn -Prelease,image package</code> in the <code>server</code>, <code>meta</code>, <code>ui</code> <code>operator</code>, and <code>s2i</code> modules.</li></ul><p>If the option <code>--dry-run</code> (short: <code>-n</code>) is provided, the script drops the staging repository at Sonatype and stops. You should examine the generated files and before starting a real build, reset the repository (<code>git reset --hard</code>).</p><p>The builds are using a clean local Maven repository, which otherwise is usually taken from <code>~/.m2/repository</code>. This new local cache should ensure that we have a completely fresh build without interference from previous builds store in the local Maven cache in the home directory. You can provide such a directory with <code>--local-maven-repo</code> which will be taken directly (so it’s good if you have to perform multiple runs like with <code>--dry-run</code>). If not provided, a new temporary directory is created and also <em>deleted</em> after the release run.</p><p><strong>Persist Steps</strong></p><ul><li>Push Docker images to Docker Hub. In addition to the images that carry the full release version as the tag, also a tag for the <em>minor version</em> is attached and pushed. E.g. when the release version is <code>1.2.8</code>, then the minor version is <code>1.2</code>. If this minor version tag already exists on Docker Hub, its moved to the newly created version.</li><li>The staging repository on Sonatype is released. It will take a bit, but the artifact should then be downloadable from <a href="https://search.maven.org/" rel="noreferrer" target="_blank">Maven central</a> soon after.</li><li>Commit all modified local files to the local Git repo.</li><li>Create a Git tag for the release version (e.g. <code>git tag 1.2.8</code>).</li></ul><p>The next steps are for creating templates for the minor version:</p><ul><li>In <code>install</code> create new templates which contain image streams that reference images with the minor version (e.g. <code>syndesis/syndesis-server:1.3</code> for a release version of 1.3.8).</li><li>Commit those generated templates</li><li>Tag it with the minor version (e.g. <code>1.2</code>), overwriting an already existing minor version tag</li></ul><p>Next, we are switching back to the next development version of the pom.xml files. This version can be given with <code>--dev-version</code>, but by default, it is calculated automatically as <code>&lt;minor.version&gt;-SNAPSHOT</code> (e.g. <code>1.2-SNAPSHOT</code>). This new version is then committed to the local git repository.</p><p>Finally, the tags just created on the local Git repo is pushed to the remote repository. You can omit this with the option <code>--no-git-push</code>. If to so, the last step can also be performed manually afterwards with:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ git push 1.2.8   
$ git push -f 1.2   <span style="color:#099">1</span></code></pre></div><p><strong>NOTE</strong>: The usage of <code>-f</code> flag as the minor tag needs to be moved.</p><p>Please be careful to <strong>not</strong> push the master branch upstream (i.e. do <strong>not</strong> a plain <code>git push</code>). We only want to have the tag with all the release preparation steps, not on the branch so that pull requests can be still be easily rebased with out conflict because of the temporary version changes.</p><h3 id="minor-version-templates">Minor Version Templates</h3><p>What is now the thing with this <em>minor version</em>? Why is the needed and how does it work?</p><p>Syndesis follows a <a href="https://semver.org/" rel="noreferrer" target="_blank">semantic versioning</a> approach. So, patch level releases (i.e. all releases which only change the last digit in 1.2.8) are fully compatible with all other patch level versions. In order to allow easy bug fix upgrades, we also create a tag which contains only the version parts up to the minor version (e.g. 1.2). These tags <strong>always</strong> points to the latest full version of its minor version. If, e.g. 1.2.8 is the latest 1.2.x version, then the tag 1.2 point to this 1.2.8 version. Corresponding to these Docker image variants, there exist two OpenShift templates variants:</p><ul><li>One set of templates directly references the Docker images which its full version, e.g. <code>syndesis/syndesis-ui:1.2.8</code>. Applying such a template will keep your application at precisely this patch-level. You would have to update your templates and recreate your applications if you want to upgrade.</li><li>The other set of templates references images only via its minor version, e.g. <code>syndesis/syndesis-ui:1.2</code>. Using these templates has the advantage that application created from these templates automatically benefit from patch releases. The templates contain an image change trigger which will redeploy the application if the images change. So when we release the next patch level release, moving the minor version tag to this patch level release, then the application gets automatically redeployed, and it will pick up the new image.</li></ul><p>These two sets of templates can be reached directly from GitHub as the git tags correspond to the Docker tags (i.e. a <code>1.2.8</code> tag and a <code>1.2</code> tag which will be moved forward).</p><h3 id="snapshot-release">Snapshot Release</h3><p>With the option <code>--snapshot-release</code> a lightweight snapshot release for the images and templates can be created. The tag/version is calculated automatically by picking up the latest release number (e.g. 1.3.5), increasing the patch-level by one and adding a daily timestamp (e.g. 1.3.6-20180419). According to <a href="https://semver.org/" rel="noreferrer" target="_blank">Semantic Versioning 2.0</a> this is considered to be a version larger than 1.3.5 but <a href="https://semver.org/#spec-item-11" rel="noreferrer" target="_blank">smaller</a> than 1.3.6.</p><p>This tag can be referenced to in <code>syndesis install</code> and <code>syndesis minishift</code>.</p><p>In detail, a snapshot release differs from a normal release as it:</p><ul><li>…​ doesn’t release artifacts on Maven central, but pushes Docker images and creates a Git tag for referencing the proper templates.</li><li>…​ skips all checks and tests when building to maximise the likelihood that the release succeeds. The rationale here is to better have untested daily snapshot release than no snapshot release because of test failure (which in many cases are not because of errors, but of failure in the infrastructure)</li><li>…​ force pushes the snapshot tag on GitHub so that multiple releases per day are allowed</li></ul><h3 id="example-2">Example</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ syndesis release <span style="color:#d14">\
</span><span style="color:#d14"></span>     --snapshot-release <span style="color:#d14">\ </span>                  <span style="color:#099">1</span>
     --local-maven-repo /tmp/clean-repo <span style="color:#d14">\ </span>  <span style="color:#099">2</span>
     --git-remote origin <span style="color:#d14">\ </span>                 <span style="color:#099">3</span>
     --docker-user <span style="color:#d14">&#34;</span><span style="color:#d14">${</span><span style="color:teal">DOCKER_USER</span><span style="color:#d14">}</span><span style="color:#d14">&#34;</span> <span style="color:#d14">\ </span>      <span style="color:#099">4</span>
     --docker-password <span style="color:#d14">&#34;</span><span style="color:#d14">${</span><span style="color:teal">DOCKER_PASSWORD</span><span style="color:#d14">}</span><span style="color:#d14">&#34;</span></code></pre></div><ol><li>Enable snapshot release with a version in the format 1.3.5-20180419</li><li>Point to an empty repository to avoid side effects when building</li><li>Push to the origin repository</li><li>Docker credentials required for pushing to Docker Hub</li></ol><p>A daily Jenkins job with this configuration run on <a href="https://ci.fabric8.io" rel="noreferrer" target="_blank">https://ci.fabric8.io</a> for creating a daily snapshots.</p><h3 id="troubleshooting">Troubleshooting</h3><p>When you run the <code>syndesis release</code> command and when it should not succeed, you might have to perform some cleanup steps yourself (there is now automatic rollback). However, care has been taken to move all persistent changes to the end of the release flow, so if something breaks early, you only need to clean up locally. If the process fails before the step <em>=== Pushing Docker images</em> you only need to:</p><ul><li>Reset your local git repo with <code>git reset --hard</code></li><li>Potentially remove the create staging repository on <code>http://oss.sonatype.org/</code> (but it doesn’t harm if it is not cleaned up immediately).</li></ul><p>After pushing the Docker images, it should be improbable that things go wrong. But these things should take care of if this should be the case:</p><ul><li>Remove Docker Hub tags for the pushed images, which is best done on the Docker Hub Web UI</li><li>Revert your local git commits to the point before the release. If you did this on a fresh checked out repo (as recommended), you just could delete the whole clone.</li></ul><h2 id="syndesis-install">syndesis install</h2><p>With <code>syndesis install</code> you can install Syndesis to an arbitrary OpenShift cluster. If you want to install to <a href="https://www.openshift.org/minishift/" rel="noreferrer" target="_blank">Minishift</a> the <a href="#syndesis-minishift">syndesis minishift</a> command is recommended as it supports some additional features specific to Minishift.</p><p>The deployment happens to the currently connected OpenShift cluster. So it’s mandatory that you have logged into the cluster with <code>oc login</code> before. You can check the status with <code>oc status</code>.</p><p>The installation process consists of two steps:</p><ul><li>An initial setup which has to be performed as <em>cluster admin</em> which is a one-off action which needs to be done only once.</li><li>Installation of Syndesis into a specific project by the <em>app admin</em>, a regular user of OpenShiftm which can be performed as many times as required.</li></ul><h3 id="initial-setup">Initial Setup</h3><p>In the initial setup, you have to register the custom resource definition (CRD) to allow to deploy <code>Syndesis</code> resources. This step has to be performed by the admin.</p><p>Also, if you want to allow an OpenShift user to install Syndesis on her own, then you have to grant specific permissions to her.</p><p>To perform this setup step, which needs to be performed only once per cluster, you have to run <code>syndesis</code> <strong>while being connected as a cluster admin</strong>. For <code>minishift</code> use <code>oc login -u system:admin</code> if you have the <code>admin-user</code> addon enabled, for crc follow the login instructions you got when starting up crc.</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ syndesis install --setup</code></pre></div><p>This will install only the CRD. In addition to grant a user <em>developer</em> the proper permission to create a <code>Syndesis</code> resource, you should add <code>--grant &lt;user&gt;</code>:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ syndesis install --setup --grant &lt;user&gt;</code></pre></div><p>This call adds permissions to read and write <code>Syndesis</code> resource objects for the current project. If you would instead want to allow the user managing <code>Syndesis</code> resources in the whole cluster, you should add a <code>--cluster</code>. This cluster-wide access is especially required when you plan to use the <code>--project</code> option to use a new project or recreate the existing one, as in this case the role association to this project gets lost.</p><h3 id="installing-syndesis">Installing Syndesis</h3><p>After the CRDs a registered, you can easily install Syndesis directly with</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ syndesis install</code></pre></div><p>Depending on whether you have granted the current user access this step has to be done either as admin or as a regular user.</p><h3 id="example-for-minishift">Example for Minishift</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#998;font-style:italic"># Enable the admin user on Minishift</span>
$ minishift addons <span style="color:#0086b3">enable</span> admin-user

<span style="color:#998;font-style:italic"># Create a minishift instance</span>
$ minishift start --memory <span style="color:#099">4192</span>

<span style="color:#998;font-style:italic"># Switch to admin</span>
$ oc login -u system:admin

<span style="color:#998;font-style:italic"># Register CRD and grant permissions to &#34;developer&#34;</span>
$ syndesis install --setup --grant developer --cluster

<span style="color:#998;font-style:italic"># Switch to account developer</span>
$ oc login -u developer

<span style="color:#998;font-style:italic"># Install Syndesis</span>
$ syndesis install</code></pre></div><p>A route name can be given with <code>--route</code>. This step can be omitted as the operator can autodetect the route. If you provide the route manually, you need to check your OpenShift installation. Typically the route name is the name of your OpenShift project followed by the cluster’s hostname. E.g. a route <code>--route proj186023.6a63.fuse-ignite.openshiftapps.com</code> is specific to the Fuse Ignite test cluster <code>6a63.fuse-ignite.openshiftapps.com</code> and for the project <code>proj186023</code>. However, you don’t have to provide the route name.</p><p>If you want to have a link to the OpenShift console to read the Pod logs, you have to add the <code>--console</code> option with the full URL to the console. If not given, no link appears.</p><p>By default, this commands installs Syndesis in the currently connected project, but you can specify an alternative project with <code>--project &lt;project&gt;</code>. If this project already exists, it gets deleted unconditionally before the deployment, so be careful when using this option. By default, you are asked whether you want to delete the project for recreation. You can switch off the security question with the option <code>--yes</code> (short: <code>-y</code>).</p><div class="alert alert-info admonition" role="alert"><i class="fa warning"></i> Don’t use `syndesis install --project $(oc project -q) --yes`. You’ll shoot yourself into the foot. Ask the author if you want to know more details.</div><p>If you want to wait until everything is running (including fetching of the Docker images), you can specify <code>--watch</code> (short: <code>-w</code>) which blocks the script until everything is set up.</p><p>You can also automatically open Syndesis in the browser after the installation with <code>--open</code> (short: <code>-o</code>)</p><h3 id="development-mode">Development Mode</h3><p>As with <a href="#syndesis-crc">syndesis crc</a> or <a href="#syndesis-minishift">syndesis minishift</a> you can also use this command to set up a development platform for Syndesis. <em>Development platform</em> here means that you can create Docker images on your own with <a href="#syndesis-build">syndesis build</a> and can use them with an automatic redeployment after the build.</p><p>You can switch on this mode with the option <code>--dev</code>. When the operator has deployed the application, the application imagestreams refer to Docker images pushed to Docker Hub. To change the imagestream references to the images built with <code>syndesis build --all-images</code>, these imagestreams needs to be patched after the initial images have been fetched from Docker Hub. If you use the <code>--dev</code> option, then this update is done automatically.</p><h3 id="selecting-the-version">Selecting the Version</h3><p>With the option <code>--tag</code> you can select a specific version of Syndesis to install. By default, the currently checked out checked out branch is used.</p><h3 id="example-3">Example</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ syndesis install --route syndesis.192.168.64.12.nip.io --tag 1.4</code></pre></div><p>This example installs the latest Syndesis version of the 1.4 branch to the local cluster.</p><p>You can see a list of available tags with <code>git tag</code>. Tags prefixed with <code>fuse-ignite</code> are suited for the Fuse Online cluster as those templates do not contain images streams themselves but refer to the image streams installed on this cluster.</p></div></div></div><div class="toc hidden-md-down"><nav id="TableOfContents"><ul><li><ul><li><a href="#buildtool-syndesis">Buildtool &ldquo;syndesis&rdquo;</a><ul><li><a href="#usage-message">Usage Message</a></li><li><a href="#rebase-to-upstream">Rebase to Upstream</a></li><li><a href="#development-modes">Development Modes</a></li><li><a href="#commands">Commands</a></li></ul></li><li><a href="#syndesis-build">syndesis build</a><ul><li><a href="#modules">Modules</a></li><li><a href="#tuning">Tuning</a></li><li><a href="#maven-mirror">Maven mirror</a></li><li><a href="#syndesis-operator">Syndesis Operator</a></li><li><a href="#examples">Examples</a></li></ul></li><li><a href="#syndesis-ui">syndesis ui</a></li><li><a href="#syndesis-crc">syndesis crc</a><ul><li><a href="#installing">Installing</a></li><li><a href="#resetting-codeready-containers">Resetting CodeReady Containers</a></li><li><a href="#example">Example</a></li></ul></li><li><a href="#syndesis-minishift">syndesis minishift</a><ul><li><a href="#installing-1">Installing</a></li><li><a href="#setting-a-maven-repository-manager">Setting a maven repository manager</a></li><li><a href="#use-the-latest-syndesis-operator">Use the latest syndesis-operator</a></li><li><a href="#installing-an-addon">Installing an addon</a></li><li><a href="#resetting-minishift">Resetting Minishift</a></li><li><a href="#example-1">Example</a></li></ul></li><li><a href="#syndesis-dev">syndesis dev</a><ul><li><a href="#debug-a-syndesis-component">Debug a syndesis component</a></li><li><a href="#prune-old-stuff">Prune old stuff</a></li><li><a href="#install-maven-nexus-as-mirror">Install Maven Nexus as mirror</a></li></ul></li><li><a href="#syndesis-release">syndesis release</a><ul><li><a href="#preparations">Preparations</a></li><li><a href="#release-steps">Release steps</a></li><li><a href="#minor-version-templates">Minor Version Templates</a></li><li><a href="#snapshot-release">Snapshot Release</a></li><li><a href="#example-2">Example</a></li><li><a href="#troubleshooting">Troubleshooting</a></li></ul></li><li><a href="#syndesis-install">syndesis install</a><ul><li><a href="#initial-setup">Initial Setup</a></li><li><a href="#installing-syndesis">Installing Syndesis</a></li><li><a href="#example-for-minishift">Example for Minishift</a></li><li><a href="#development-mode">Development Mode</a></li><li><a href="#selecting-the-version">Selecting the Version</a></li><li><a href="#example-3">Example</a></li></ul></li></ul></li></ul></nav></div></div><footer class="page-footer text-center"><div class="row"><section class="col-md-6"><i class="fab fa-3x fa-github" aria-hidden="true"></i><h4>Get the source code</h4><p>Stay tuned to contribute or build your own solution.</p><p class="link-button"><a href="https://github.com/syndesisio" rel="nofollow" target="_blank" class="btn btn-primary">Syndesis on GitHub</a></p></section><section class="col-md-6"><i class="fas fa-3x fa-comments"></i><h4>Connect with us</h4><p>Chat with the Syndesis community.</p><p class="link-button"><a href="https://gitter.im/syndesisio/community" rel="nofollow" target="_blank" class="btn btn-primary">syndesisio on Gitter</a></p></section></div><div class="rh-logo"><section><a href="https://www.redhat.com" rel="nofollow" title="Red Hat, Inc." target="_blank"><img width="128" height="42" src="https://syndesis.io/images/redhatnew.svg" alt="Red Hat, Inc."></a></section></div></footer></div><script src="https://syndesis.io/js/syndesis.js"></script><script>var languagedir=JSON.parse('"ltr"');window.onload=function(){var e=document.getElementById("navCollapseBtn");e&&e.addEventListener("click",function(e){var t=document.querySelector(".navbar__collapse");t&&("true"===t.getAttribute("data-open")?(t.setAttribute("data-open","false"),t.style.maxHeight=0):(t.setAttribute("data-open","true"),t.style.maxHeight=t.scrollHeight+"px"))}),document.querySelectorAll(".menu__list").forEach(function(e){0<e.querySelectorAll(".active").length&&(e.style.maxHeight=e.scrollHeight+"px")}),document.querySelectorAll(".menu__title--collapse").forEach(function(e){e.addEventListener("click",function(e){var t=this.nextElementSibling,l=this.querySelector(".menu__title--icon");if(!t)return null;t.style.maxHeight?(t.style.maxHeight=null,t.classList.remove("active"),"rtl"===languagedir?l.classList.remove("downrtl"):l.classList.remove("down")):(t.style.maxHeight=t.scrollHeight+"px",t.classList.add("active"),"rtl"===languagedir?l.classList.add("downrtl"):(l.classList.add("down"),l.classList.remove("right")))})})}</script></body></html>