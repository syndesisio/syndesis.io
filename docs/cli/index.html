<!DOCTYPE html><html lang="en-gb"><head><meta name="generator" content="Hugo 0.62.2"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Syndesis CLI | Syndesis</title><script type="application/javascript">var doNotTrack=!1;doNotTrack||(!function(a,e,t,n,o,c,g){a.GoogleAnalyticsObject=o,a.ga=a.ga||function(){(a.ga.q=a.ga.q||[]).push(arguments)},a.ga.l=1*new Date,c=e.createElement(t),g=e.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",g.parentNode.insertBefore(c,g)}(window,document,"script",0,"ga"),ga("create","UA-98663114-1","auto"),ga("send","pageview"))</script><link rel="canonical" href="https://syndesis.io/docs/cli/"><link rel="icon" type="image/png" href="https://syndesis.io/images/favicon.png"><meta name="generator" content="Hugo 0.62.2"><link href="https://fonts.googleapis.com/css?family=Raleway:400,500|Righteous" rel="stylesheet"><link rel="stylesheet" href="https://syndesis.io/css/syndesis.css"></head><body class="docs"><div id="wrapper"><a href="https://github.com/syndesisio" class="github-corner hidden-md-down" aria-label="View source on Github" rel="nofollow" target="_blank"><svg width="74" height="74" viewBox="0 0 250 250" style="fill:#fff;z-index:2000;color:#0088ce;mix-blend-mode:screen;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7
        120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9
        125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6
        C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0
        C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1
        C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4
        C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9
        C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5
        C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9
        L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><nav class="navbar fixed-top navbar-inverse bg-primary navbar-toggleable-md sps sps--abv"><button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-nav" aria-controls="top-nav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button> <a href="https://syndesis.io/" title="Syndesis"><svg id="artwork" xmlns="http://www.w3.org/2000/svg" width="190px" height="39.33px" viewBox="0 0 1300 300" preserveAspectRatio="xMidYMin slice"><defs><style>.cls-1{fill:#9adde8}.cls-2{fill:#49badc}.cls-3{fill:#fff}</style></defs><title>Syndesis Logo</title><polygon class="cls-1" points="129.95 98.77 33.99 144.38 122.22 167.37 218.18 121.75 129.95 98.77"/><polygon class="cls-2" points="218.18 121.75 218.18 121.75 122.22 167.37 242.17 198.61 218.18 121.75"/><polygon class="cls-1" points="154.99 86.86 131 10 10 67.52 129.95 98.77 154.99 86.86"/><polygon class="cls-2" points="33.99 144.38 129.95 98.77 10 67.52 10 67.52 33.99 144.38"/><polygon class="cls-2" points="189.64 25.27 131 10 154.99 86.86 213.63 102.14 189.64 25.27"/><polygon class="cls-2" points="38.54 164 62.53 240.86 121.17 256.13 121.17 256.13 97.18 179.27 97.18 179.27 38.54 164"/><polygon class="cls-1" points="242.17 198.61 122.22 167.37 97.18 179.27 121.17 256.13 242.17 198.61"/><path class="cls-3" d="M358.91,210.23c-23.57,0-43.44-17.22-44.06-41.6H329.2c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.65-9.63,35.65-28.48,0-14.76-10.65-21.73-23.15-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.15,35.25H399.28c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C416.29,200.39,388.62,210.23,358.91,210.23Z"/><path class="cls-3" d="M484.32,143.22l-54.51-84h17l45.29,71.52L537.4,59.2h14.34l-54.1,83.61v64.34H484.32Z"/><path class="cls-3" d="M572.24,59.2H587.4L669,189.32h.41V59.2h13.32v148h-16.8L586,79.28h-.41V207.15H572.24Z"/><path class="cls-3" d="M760,59.2c48.56,0,76.23,25,76.23,74s-27.67,74-76.23,74H720V59.2Zm3.27,135.66c41.6,0,58.61-24.39,58.61-61.69,0-43.64-25.61-62.91-67.62-61.68h-20.9V194.86Z"/><path class="cls-3" d="M870.19,207.15V59.2H958.1V71.49H883.51v53.08h71.73v12.29H883.51v58h77.67v12.29Z"/><path class="cls-3" d="M1030.44,210.23c-23.56,0-43.44-17.22-44.05-41.6h14.34c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.66-9.63,35.66-28.48,0-14.76-10.66-21.73-23.16-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.16,35.25h-14.35c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C1087.82,200.39,1060.16,210.23,1030.44,210.23Z"/><path class="cls-3" d="M1121.63,207.15V58.58H1135V207.15Z"/><path class="cls-3" d="M1212.62,210.23c-23.56,0-43.44-17.22-44.06-41.6h14.35c.41,22.74,17.21,29.3,37.09,29.3,16.6,0,35.66-9.63,35.66-28.48,0-14.76-10.66-21.73-23.16-25.82-24-8-60.45-15.58-60.45-47.55,0-25.82,23.77-40,47.13-40,19.47,0,44.88,6.77,48.16,35.25H1253c-.41-18.24-17-23-32.17-23-15.37,0-34.43,7.79-34.43,25.82,0,42,83.61,23,83.61,74C1270,200.39,1242.34,210.23,1212.62,210.23Z"/></svg></a><div class="collapse navbar-collapse" id="top-nav"><ul class="navbar-nav ml-auto mt-2 mt-md-0 mr-lg-4"><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/quickstart/">quickstart</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/docs/">docs</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/blog/">blog</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/faq/">faq</a></li><li class="nav-item ml-lg-3 ml-0"><a class="nav-link" href="https://syndesis.io/community/">community</a></li></ul></div></nav><div id="main" class="d-flex flex-row"><div id="sidebar" class="sidenav"><aside><ul class="sidebar-menu"><li class="nav-button hidden-lg-up"><button type="button" class="btn btn-primary btn-sm" data-toggle="offcanvas" data-target="#sidebar">Hide nav</button></li><li><a class="" href="https://syndesis.io/about/"><i class="fa fa-fw fa-download"></i> <span>About Syndesis</span></a></li><li><a class="" href="https://syndesis.io/quickstart/"><i class="fa fa-fw fa-rocket"></i> <span>Quickstart</span></a></li><li class="sub-menu active"><a class="d-flex justify-content-between" href="https://syndesis.io/docs/"><span><i class="fa fa-fw fa-book"></i> Developer Docs</span> <span class="mr-1 expander"></span></a><ul class="sub collapse show"><li><a href="https://syndesis.io/docs/development/">Development</a></li><li><a href="https://syndesis.io/docs/backend_architecture/">Backend architecture</a></li><li class="active"><a href="https://syndesis.io/docs/cli/">CLI</a></li><li><a href="https://syndesis.io/docs/connectors/">Developing Syndesis connectors</a></li><li><a href="https://syndesis.io/docs/datashapes/">Data Shapes</a></li><li><a href="https://syndesis.io/docs/connector-schema/">Connector Schema explained</a></li></ul></li><li><a class="" href="https://syndesis.io/faq/"><i class="fa fa-fw fa-file-text"></i> <span>FAQ</span></a></li><li class="sub-menu"><a class="d-flex justify-content-between" href="https://syndesis.io/community/"><span><i class="fa fa-fw fa-group"></i> Community</span> <span class="mr-1 expander"></span></a><ul class="sub collapse"><li><a href="https://syndesis.io/community/contributing/">Contributing</a></li><li><a href="https://syndesis.io/community/engineering_guidelines/">Engineering Guidelines</a></li></ul></li><li><a href="https://github.com/syndesisio/syndesis/issues/" target="blank"><i class="fa fa-life-ring"></i> <span>Issues & Help</span></a></li><li><a href="https://github.com/syndesisio/syndesis.io/edit/master/content/docs/cli.md" target="blank"><i class="fa fa-fw fa-edit"></i> Refine this Page</a></li></ul></aside></div><div class="main-content"><div itemscope class="doc"><meta itemprop="name" content="Syndesis CLI"><meta itemprop="description" content="Buildtool &ldquo;syndesis&rdquo; Syndesis uses a single tool for controlling various aspects of the build and developer related tasks. This script can be found in $SYNDESIS_DIR/tools/bin and is called syndesis. It requires bash and can be used on any Unix or macOS.
To have this script handy all the time it is recommended to either put this bin/ directory into the path or add a symlink from syndesis into a directory which is already on your execution path."><meta itemprop="wordCount" content="6814"><meta itemprop="keywords" content=""><div class="hero"><h1 itemprop="headline">Syndesis CLI</h1></div><div itemprop="docBody" class="docBody"><h2 id="buildtool-syndesis">Buildtool &ldquo;syndesis&rdquo;</h2><p>Syndesis uses a single tool for controlling various aspects of the build and developer related tasks. This script can be found in <code>$SYNDESIS_DIR/tools/bin</code> and is called <code>syndesis</code>. It requires bash and can be used on any Unix or macOS.</p><p>To have this script handy all the time it is recommended to either put this <code>bin/</code> directory into the path or add a symlink from <code>syndesis</code> into a directory which is already on your execution path.</p><p>The script can be used for various tasks which are selected by a so-called command_ which is the first argument to the script.</p><p>Just type <code>syndesis -h</code> to get an overview of the commands available:</p><h3 id="usage-message">Usage Message</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Usage: syndesis &lt;command&gt; [... options ...]

with the following commands

   build            Build Syndesis
   dev              Developer tools
   doc              Generate Syndesis Developer Handbook (SDH)
   minishift        Initialize and manage a Minishift developer environment
   system-test      Run system tests

&#34;build&#34; is the default command if no command is specified.</code></pre></div><p>There are a handful of global options which can be used:</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><code>--help</code></td><td><code>-h</code></td><td>Print usage information. If a command is given print out commands specific options.</td></tr><tr><td><code>--rebase</code></td><td><code>-r</code></td><td>Rebase your project directory before building to integrate upstream changes to your local repository. See below for details how this works.</td></tr><tr><td><code>--verbose</code></td><td>&nbsp;</td><td>Set verbose mode, which is useful mostly only for debugging the script itself.</td></tr></tbody></table><h3 id="rebase-to-upstream">Rebase to Upstream</h3><p>To easily rebase on changes which have been merged upstream to master, you can use the option <code>--rebase</code> (short: <code>-r</code>). This command assumes that you have forked the Syndesis GitHub repositories and you have &ldquo;origin&rdquo; and &ldquo;upstream&rdquo; remotes like</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git remote -v
origin    git@github.com:rhuss/syndesis.git (fetch)
origin    git@github.com:rhuss/syndesis.git (push)
upstream  https://github.com/syndesisio/syndesis (fetch)
upstream  https://github.com/syndesisio/syndesis (push)</code></pre></div><p>With this in place, a <code>--rebase</code> performs the following steps:</p><ul><li>Refresh upstream remote: <code>git fetch upstream master</code></li><li>Try a <code>git rebase upstream/master</code> which rebases your current local working branch.</li><li>If this fails because you have uncommitted work:<ul><li>A <code>git stash</code> is performed</li><li>The rebase is retried and should succeed</li><li><code>git stash pop</code> brings back your changes. Stashing can fail with conflicts which you would have to resolve on your own.</li></ul></li></ul><h3 id="development-modes">Development Modes</h3><p>The Syndesis application consists of a set of Docker images OpenShift resources descriptors for installing Syndesis. For development, <a href="https://www.openshift.org/minishift/" rel="noreferrer" target="_blank">minishift</a> is used, and most of the commands assume that you have minishift installed locally and executable directly from your path. Minishift can be downloaded and installed from <a href="https://github.com/minishift/minishift/releases" rel="noreferrer" target="_blank">https://github.com/minishift/minishift/releases</a>.</p><p>For development OpenShift S2I builds and image streams are used. This mode works also when running with a real OpenShift cluster and is not restricted to Minishift usage. The advantage is that a build automatically triggers a redeployment, so you don&rsquo;t have to kill any pods manually.</p><h3 id="commands">Commands</h3><p>All other options are specific to each command. You get a list of those options with <code>syndesis &lt;cmd&gt; -h</code>. These options are described in detail in the next sections.</p><p>The following commands are available:</p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>build</td><td>Used for building Syndesis and its various modules</td></tr><tr><td>ui</td><td>Start the UI for local development <em>(not implemented yet)</em></td></tr><tr><td>minishift</td><td>Start and install Syndesis on Minishift</td></tr><tr><td>install</td><td>Install Syndesis in a running cluster (other than Minishift)</td></tr><tr><td>system-test</td><td>Run System test against an OpenShift cluster</td></tr><tr><td>dev</td><td>Utility commands useful during development</td></tr><tr><td>doc</td><td>Generating and publish this documentation</td></tr><tr><td>release</td><td>Release Syndesis&rsquo; Maven and NPM artifacts <em>(not implemented yet)</em></td></tr></tbody></table><p>If no command is given, <code>build</code> is the default. Remember a command must be the first argument, but there are additional possibilities to specify commands:</p><ul><li>You can use the form <code>--command</code> anywhere as an option, too. E.g. using <code>--minishift</code> is the same as specifying &ldquo;minishift&rdquo; as the first argument.</li><li>A <code>--mode command</code> can be used, too (e.g. <code>--mode sytem-test</code>)</li></ul><p>The next sections describe the commands in detail. To add a new command, just drop a script file into <code>$SYNDESIS_DIR/tools/bin/commands</code> directory with following structure:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#999;font-weight:700;font-style:italic">#!/bin/bash
</span><span style="color:#999;font-weight:700;font-style:italic"></span>
yourscriptname::description<span style="color:#000;font-weight:700">(</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000;font-weight:700">{</span>
    <span style="color:#0086b3">echo</span> <span style="color:#d14">&#34;Describe the command&#34;</span>
<span style="color:#000;font-weight:700">}</span>

yourscriptname::usage<span style="color:#000;font-weight:700">(</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000;font-weight:700">{</span>
    cat <span style="color:#d14">&lt;&lt;EOT
</span><span style="color:#d14">    Describe the usage of the command
</span><span style="color:#d14">EOT</span>
<span style="color:#000;font-weight:700">}</span>

yourscriptname::run<span style="color:#000;font-weight:700">(</span><span style="color:#000;font-weight:700">)</span> <span style="color:#000;font-weight:700">{</span>
    Do your stuff
<span style="color:#000;font-weight:700">}</span></code></pre></div><h2 id="syndesis-build">syndesis build</h2><p>The primary goal of <code>syndesis build</code> is to build Syndesis.</p><p>It is mainly a wrapper around Maven and Go but adds some convenience functionality for common developer workflows.</p><h3 id="usage">Usage</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Usage: syndesis build [... options ...]

Options for build:
    -b  --backend                  Build only backend modules (core, extension, integration,
                                   connectors, server, meta)
        --all-images               Build all modules with images: ui, server, meta, s2i, operator
        --app-images               Build only application modules with Docker images
                                   (ui, server, meta, s2i)
                                   and create images
        --infra-images             Build only infrastructure modules with Docker images
                                   (operator) and create images
    -m  --module &lt;m1&gt;,&lt;m2&gt;, ..     Build modules
                                   Modules: ui, server, connector, s2i, meta, integration,
                                   extension, common, operator
    -d  --dependencies             Build also all project the specified module depends on
        --skip-tests               Skip unit and system test execution
        --skip-checks              Disable all checks
    -f  --flash                    Skip checks and tests execution (fastest mode)
    -i  --image                    Build Docker images, too
                                   (for those modules creating images)
        --docker                   Use a plain Docker build for creating images.
                                   Used by CI for pushing to Docker Hub
    -p  --project &lt;project&gt;        Specifies the project/namespace to create images in
    -e  --ensure                   If building the operator, run &#39;dep ensure&#39; before building.
                                   Otherwise ignored.
    -l  --local                    If building the operator, use a locally installed go
                                   Otherwise run the Go build from a container
                                   (either local or Minishift&#39;s Docker daemon)
        --clean-cache              Used for the operator build to remove the local dependency cache.
    -c  --clean                    Run clean builds (mvn clean)
        --resume &lt;m1&gt;              Resume build from maven module (mvn -rf m1)
        --batch-mode               Run mvn in batch mode
        --camel-snapshot &lt;version&gt; Run a build with a specific Camel snapshot.
                                   If no argument is given the
                                   environment variable CAMEL_SNAPSHOT_VERSION is used or an error thrown.</code></pre></div><h3 id="modules">Modules</h3><p>A plain <code>build</code> command without any options performs a plain <code>mvn install</code> for all Java and UI modules. Plus it also builds the infrastructure operator via Go (see <a href="#infrastructure-operator">syndesis-build-operator</a> for details)</p><p>This compiles all Java and Javascript artifacts and also runs all tests and code checks for the application modules.</p><p>You restrict the build to certain modules, which are divided into two categories: <em>application modules</em> which are the modules building up Syndesis. And <em>infrastructure modules</em> which help in managing the application itself.</p><p>You can individually select specific modules by using the <code>--module</code> (short: <code>-m</code>) option with a comma-separated list of modules, but there are also option to combine modules</p><p>The following modules are available:</p><table><thead><tr><th>Module</th><th>Description</th><th><code>--all-images</code></th><th><code>--backend</code></th><th><code>--app-images</code></th><th><code>--infra-images</code></th></tr></thead><tbody><tr><td><strong>server</strong></td><td>Main backend providing a REST API for the user interface</td><td>✔︎</td><td>✔︎</td><td>✔︎</td><td></td></tr><tr><td><strong>ui</strong></td><td>The SPA user interface application</td><td>✔︎</td><td></td><td>✔︎</td><td></td></tr><tr><td><strong>meta</strong></td><td>Meta data and verifier used for verifying connections and providing connector metadata</td><td>✔︎</td><td>✔︎</td><td>✔︎</td><td></td></tr><tr><td><strong>connector</strong></td><td>All connectors used by Syndesis out of the box</td><td></td><td>✔︎</td><td></td><td></td></tr><tr><td><strong>integration</strong></td><td>Support libraries for running integrations</td><td></td><td>✔︎</td><td></td><td></td></tr><tr><td><strong>extension</strong></td><td>Tools for developing and running Syndesis custom extensions</td><td></td><td>✔︎</td><td></td><td></td></tr><tr><td><strong>common</strong></td><td>Common modules containing common code</td><td></td><td>✔︎</td><td></td><td></td></tr><tr><td><strong>s2i</strong></td><td>S2I base image used for building the runtime images</td><td>✔︎</td><td></td><td>✔︎</td><td></td></tr><tr><td><strong>operator</strong></td><td>Infrastructure operator for managing the application</td><td>✔︎</td><td></td><td></td><td>✔︎</td></tr></tbody></table><p>All option ending with <code>-images</code> will also build the corresponding Docker image.</p><p>When you build individual modules you you can provide the option <code>--image</code> (short: <code>-i</code>) to create also the Docker image in the build, when the module is associated with a Docker image.</p><p>By default images are build via S2I against a running Minishift. This is the recommended way for developing as this automatically will trigger a redeployment after the build. However, for certain scenarios like when used in a CI system or when doing the release, the image creation can be done against are Docker daemon when the <code>--docker</code> is given. For this to work you must have access to Docker daemon, which you can verify with <code>docker ps</code>.</p><p>When the option <code>--dependencies</code> (short: <code>-d</code>) is given in addition to <code>--modules</code>, also all Maven modules which the specified modules depend on are build, too.</p><h3 id="tuning">Tuning</h3><p>By default, all checks like license or code quality checks are performed. Also, all unit and local integration tests are run. A full build eats up quite some time, but you should always run at full blast before submitting a pull request.</p><p>However, to speed up the turnaround, several speed-up options are available. The following table shows these options, and also how long a full clean build over all modules takes: (but without building images)</p><table><thead><tr><th>Option</th><th>Description</th><th>Time</th></tr></thead><tbody><tr><td><em>none</em></td><td>Default mode with all checks and tests</td><td></td></tr><tr><td><code>--skip-tests</code></td><td>Skip all unit and local integration tests</td><td></td></tr><tr><td><code>--skip-checks</code></td><td>Skip sanity checks like for correct license headers and</td><td></td></tr><tr><td><code>--flash</code></td><td>Fastest mode with skipping all checks and tests and with even some other aggressive optimizations</td><td></td></tr></tbody></table><h3 id="infrastructure-operator">Infrastructure Operator</h3><p><code>syndesis build</code> can also build the infrastructure operator, which is a golang program.</p><p>You can build the operator by running <code>syndesis build -m operator</code> or as part of a module collection like <code>--all-images</code> or <code>--infra-images</code></p><p>There are three modes, how the operator can be created:</p><ul><li><p>Running you go compiler locally</p></li><li><p>Compiling in a local Docker daemon which allows volume mounts with the localhost</p></li><li><p>Compiling in Minishift Docker daemon, which was made accessible via <code>eval $(minishift docker-env)</code></p></li></ul><p>See below for the details.</p><p><strong>Load dependencies</strong></p><p>In any case, before you compile first you should use the option <code>--ensure</code> (short: <code>-e</code>) to setup the dependency tree. This will download all source dependency and cache them locally. To get rid of this cache, use the option <code>--clean-cache</code>. This might be necessary when <code>go dep</code> &rsquo;s cache gets into a weird state.</p><p>If you compile for the first time, then <code>--ensure</code> will be added automatically.</p><p><strong>Compiling locally</strong></p><p>This is the fastest way for compiling the operator. Use the option <code>--local</code> (short: <code>-l</code>) for selecting the local compile mode.</p><p>It is also the recommended way when you are working on the operator. You project setup needs to fit however: The main project directory must be reachable as <code>$GOPATH/src/github.com/syndesisio/syndesis</code>. You can either move your project directory to this location or work with a symlink:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#0086b3">cd</span> ~/Development/syndesis
mkdir -p <span style="color:teal">$GOPATH</span>/src/github.com/syndesisio
<span style="color:#0086b3">cd</span> ..
mv syndesis <span style="color:teal">$GOPATH</span>/src/github.com/syndesisio/
ln -s <span style="color:teal">$GOPATH</span>/src/github.com/syndesisio/ syndesis</code></pre></div><p>By default this compiles into for your native architecture (amd64, darwin). When you use this mode with <code>--image</code> (short: <code>-i</code>) on macOS then go will be used as cross compiler so that the generated bimary can be used in a Linux image.</p><p><strong>Compiling with a local Docker daemon</strong></p><p>This is the default mode and is used also when doing the release. It use a builder image <code>syndesis/godev</code> which is created from the <code>tools/image</code> directory and fetched from Docker Hub.</p><p>For this mode to work your Docker daemon must support volume mounts to the system from where you are calling <code>syndesis</code>. This is the case on Linux for locally installed Docker daemon and for Mac with <em>Docker for Mac</em>. It is <strong>not</strong> the case for Minishift which runs in a disconnected VM. But see below how you still can use Minishift for building.</p><p><code>dep ensure</code> and <code>go build</code> will be run from this <code>syndesis/godev</code> image, but with your local directory mounted into the container so that the fetched dependencies can be cached in the local directories <code>dep-cache</code> and <code>vendor</code> so that the can be reused for the next run. Also the binary will be stored in your local directory, but this will alway be a Linux (<code>amd64</code>) binary.</p><p><strong>Compiling with Minishift</strong></p><p>As Minishift is running in a remote VM you cannot bind a volume to your localhost. Therefor when running in Minishift mode the source code will be rsynced to a directory in the Minishift VM (<code>rsync</code> will be installed in the Minishift VM on the first run).</p><p>The build with <code>syndesis/godev</code> will then be started with a volume mount to the copied directory in the VM. After the build the generated binary is copied back with <code>rsync</code> to your local directory.</p><p>The Minishift mode is automatically detected and selected if <code>DOCKER_CERTS</code> contains a path to <code>.minishift</code>. You enable the Minishift Docker daemon for your local CLI with <code>eval $(minishift docker-env)</code></p><p>Some simple benchmark reveals the following timings (in minutes) :</p><table><thead><tr><th>Context</th><th>Local</th><th>Local Docker (macOS)</th><th>Minishift Docker</th></tr></thead><tbody><tr><td>Cold (no build cache)</td><td>0:40</td><td>10:09</td><td>1:36</td></tr><tr><td>Hot (with dep cache)</td><td>0:08</td><td>2:47</td><td>0:13</td></tr></tbody></table><p>The fastest mode is obviously the local mode, followed surprisingly by Minishift. The local mode is probably slow because of how the macOS daemon mounts ts volumes (which can probably be optimized)</p><h3 id="examples">Examples</h3><p>Some common usage examples for <code>syndesis build</code> are</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#998;font-style:italic"># Build all images (app and infrastructure) with S2I</span>
syndesis build --all-images

<span style="color:#998;font-style:italic"># Create all application images and re-deploy Syndesis in the</span>
<span style="color:#998;font-style:italic"># Openshift cluster, but do it as fast as possible. Don&#39;t build</span>
<span style="color:#998;font-style:italic"># any golang code</span>
syndesis build --app-images --flash

<span style="color:#998;font-style:italic"># Create the infrastructure operator by running go locally</span>
<span style="color:#998;font-style:italic"># and calling dep ensure before</span>
syndesis build -m operator --local --ensure

<span style="color:#998;font-style:italic"># Use a Camel snapshot for a clean build, build all modules</span>
syndesis build --clean --camel-snapshot 2.21.0-SNAPSHOT</code></pre></div><h2 id="syndesis-ui">syndesis ui</h2><div class="alert alert-info admonition" role="alert"><i class="fa note"></i> "syndesis ui" is not implemented yet.</div><h2 id="syndesis-minishift">syndesis minishift</h2><p>With <code>syndesis minishift</code> you can adequately manage a <a href="https://www.openshift.org/minishift/" rel="noreferrer" target="_blank">minishift</a> installation for hosting Syndesis. This command is especially useful for a simple and self-contained development workflow.</p><p><code>syndesis minishift</code> requires that you have a current minishift in your path. You can download it directly from <a href="https://github.com/minishift/minishift/releases" rel="noreferrer" target="_blank">GitHub</a>.</p><h3 id="usage-1">Usage</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">--install                 Install templates to a running Minishift.
-p  --project             Install into this project.
                          Delete this project if it already exists.
                          By default, install into the current project (without deleting)
-c  --context             Install into this context. Default is &#39;minishift&#39;
--reset                   Reset and initialize the minishift installation by
                          &#39;minishift delete &amp;&amp; minishift start&#39;.
--full-reset              Full reset and initialie by
                          &#39;minishift stop &amp;&amp; rm -rf ~/.minishift/* &amp;&amp; minishift start&#39;
--memory &lt;mem&gt;            How much memory to use when doing a reset. Default: 4912
--cpus &lt;nr cpus&gt;          How many CPUs to use when doing a reset. Default: 2
--disk-size &lt;size&gt;        How many disk space to use when doing a reset. Default: 20GB
--vm-driver &lt;driver&gt;      Which virtual machine driver to use (depends on OS)
--show-logs               Show minishift logs during startup
--openshift-version &lt;ver&gt; Set OpenShift version to use when reseting (default: v3.9.0)
--tag &lt;tag&gt;               Syndesis version/tag to install. If not given, then the latest
                          version from master is installed
--local                   Use the local resource files instead of fetching them from GitHub
-o  --open                Open Syndesis in the browser
-y  --yes                 Assume &#39;yes&#39; automatically when asking for deleting
                          a given project.
--memory-server &lt;mem&gt;     Memory limit to set for syndesis-server. Specify as &#34;800Mi&#34;
--memory-meta &lt;mem&gt;       Memory limit to set for syndesis-meta. Specify as &#34;512Mi&#34;
--test-support            Allow test support endpoint for syndesis-server
--man                     Open HTML documentation in the Syndesis Developer Handbook</code></pre></div><h3 id="installing-syndesis">Installing Syndesis</h3><p>You can easily install Syndesis with the option <code>--install</code>. This option triggers the creation of all relevant OpenShift resources objects in the currently connected OpenShift project.</p><p>If you want to use a different project, then use <code>--project</code> (short: <code>-p</code>) to specify this project.</p><div class="alert alert-info admonition" role="alert"><i class="fa warning"></i> Any existing project will be deleted first when specified with `--project`. This option is also an easy and quick way to recreate a Syndesis installation.</div><h3 id="resetting-minishift">Resetting Minishift</h3><p>The quickest way to get a fresh Syndesis setup is to use <code>--project</code> which will install Syndesis into a clean, new project.</p><p>However, you can also recreate the whole Minishift installation with <code>--reset</code>. This will delete the Minishift VM (<code>minishift delete</code>) and create a new one (<code>minishift start</code>). It doesn’t harm if the Minishift VM does not exist so that you can use <code>--reset</code> also on a fresh Minishift installation.</p><p>If you want to get a real clean installation use <code>--full-reset</code> which deletes the <code>~/.minishift</code> directory which holds downloaded artifacts like the ISO image for the Minishift VM. Using <code>--full-reset</code> forces Minishift to re-download all those files.</p><p>There are several options which influence the re-creation of the VM:</p><table><thead><tr><th>Option</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>--memory</code></td><td>Memory to use for the Minishift VM.</td><td>4 GB</td></tr><tr><td><code>--cpus</code></td><td>Number of CPUs used for the Minishift VM.</td><td>2</td></tr><tr><td><code>--disk-size</code></td><td>Disk space used for Minishift.</td><td>20 GB</td></tr><tr><td><code>--show-logs</code></td><td>Whether to show OpenShift logs during startup.</td><td>false</td></tr><tr><td><code>--vm-driver</code></td><td>Which virtual machine driver to use. For OS X this can be &lsquo;virtualbox&rsquo;, &lsquo;xhyve&rsquo; or &lsquo;vmwarefusion&rsquo; (if installed).</td><td></td></tr><tr><td><code>--openshift-version</code></td><td>OpenShift version to use</td><td>3.7.1</td></tr></tbody></table><h3 id="example">Example</h3><p>This short example performs the following actions:</p><ul><li><p>Stops and deletes a running Minishift VM (if existent)</p></li><li><p>Removes <code>~/.minishift</code> (if existent)</p></li><li><p>Install Syndesis in OpenShift modes (S2I builds &amp; image streams) in project <code>syndesis</code></p></li><li><p>Open Syndesis UI in the default browser</p></li></ul><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Complete fresh installation in project &#34;syndesis&#34;
syndesis minishift --full-reset --install --project syndesis

# Open Syndesis in default browser
syndesis minishift -o</code></pre></div><h2 id="syndesis-system-test">syndesis system-test</h2><p>The <code>system-test</code> command is for running a full blown system test of Syndesis by installing it in one of multiple projects which are managed in a pool.</p><h3 id="usage-2">Usage</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Usage: syndesis system-test [... options ...]

Options for system-test:
    --project &lt;project&gt;       The test project to use
    --token &lt;token&gt;           Token for connecting to the server
    --server &lt;url&gt;            OpenShift server url to use for the tests.
                              If not given, use the currently connected server
    --pool &lt;project&gt;          If no project is given, use a pooling mechanism.
                              This pool has to be created before with --create-pool
    --test-id &lt;id&gt;            Id to identify the test run
    --create-pool &lt;prefix&gt;    Create project pool for system-tests with
                              all projects with the given prefix
    --list-pool               Show all locks for the pool
    --release-project &lt;t-id&gt;  Release project for given test id (or all if no test id is given)</code></pre></div><h3 id="how-it-works">How it works</h3><div class="alert alert-info admonition" role="alert"><i class="fa note"></i> This section needs a more detailed explanation how the systems tests are working in detail.</div><h2 id="syndesis-dev">syndesis dev</h2><p>Dev commands are useful helpers for developing Syndesis</p><h3 id="usage-3">Usage</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Usage: syndesis dev [... options ...]

Options for dev:
    --debug &lt;name&gt;            Setup a port forwarding to &lt;name&gt; pod (default: server)</code></pre></div><p>This command enable port-forwarding of port 5005 from a specific pod (by default: &ldquo;server&rdquo;) to port 5005 on the localhost. You then can point your Java IDE to port 5005 on localhost for connecting for remote debugging. As argument to <code>--debug</code> &ldquo;server&rdquo;, &ldquo;meta&rdquo; and &ldquo;atlasmap&rdquo; can be used, which are our Java based services.</p><h2 id="syndesis-doc">syndesis doc</h2><p>This command is used to generated and manage this documentation which you are currently reading.</p><h3 id="usage-4">Usage</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Usage: syndesis doc [... options ...]

Options for doc:
-d  --directory &lt;dir&gt;         Top-level dir holding doc source and output directory. Default: &#34;doc/sdh&#34;
-i  --input &lt;file&gt;            Input file to use. Default: &#34;index.adoc&#34;
    --out &lt;dir&gt;               Directory to generate files (default: &#34;output&#34;)
    --html                    Generate HTML pages
    --pdf &lt;out&gt;               Generate PDF and write it to &lt;out&gt; (default: &#34;sdh.pdf&#34;)
    --epub &lt;out&gt;              Generate Epub and write it to &lt;out&gt; (default: &#34;sdh.epub&#34;)
    --gh-pages &lt;msg&gt;          Create everything into the gh-pages branch and commit with &lt;msg&gt;
-o  --open                    Open HTML documentation in default browser after doc generation
-l  --local                   Use locally installed commands instead of Docker image</code></pre></div><p><code>syndesis doc</code> uses by default a Docker container to create the documentation. Therefore a Docker daemon must be accessible, and it must allow <a href="https://docs.docker.com/engine/admin/volumes/bind-mounts/" rel="noreferrer" target="_blank">bind volume mounts</a> to the local <code>doc/sdh</code> directory. Bind mounts are possible for Linux Docker daemons and for &ldquo;Docker for Mac&rdquo;. But it is not the case for the Minishift exposed Docker daemon, as this daemon is running isolated in a VM.</p><p>You can always run <code>asciidoctor</code> locally with the <code>--local</code> (short: <code>-l</code>) options. See the <a href="https://asciidoctor.org/#installation" rel="noreferrer" target="_blank">Asciidoctor manual</a> for more information how to install Asciidoctor.</p><h3 id="output">Output</h3><p>Input and output has the same defaults but can be changed with the following options</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><code>--input &lt;file&gt;</code></td><td><code>-i &lt;file&gt;</code></td><td>Input document in Asciidoc format which is by default <code>$SYNDESIS_DIR/doc/sdh/index.adoc</code></td></tr><tr><td><code>--output &lt;dir&gt;</code></td><td><code>-o &lt;dir&gt;</code></td><td>Output directory, default is <code>$SYNDESIS_DIR/doc/sdh/output</code></td></tr></tbody></table><p>By default <code>syndesis doc</code> creates the documentation in HTML format, but more formats are supported:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><code>--html</code></td><td>Create HTML documentation in the output directory</td></tr><tr><td><code>--pdf &lt;name&gt;</code></td><td>Create PDF documentation. <code>&lt;name&gt;</code> is optional, but when given, then this specifies the file name generated in the output directory. By default <code>sdh.pdf</code> is used.</td></tr><tr><td><code>--epub &lt;name&gt;</code></td><td>Create the documentation in Epub format. <code>&lt;name&gt;</code> is optional, but when given, then this specifies the file name generated in the output directory. By default <code>sdh.epub</code> is used.</td></tr></tbody></table><h2 id="syndesis-release">syndesis release</h2><p>Use <code>syndesis release</code> for performing a release of Syndesis. A Syndesis release consists of:</p><ul><li><p>Maven artifacts of the backend and runtime services</p></li><li><p>Docker images pushed to Docker Hub</p></li><li><p>A set of OpenShift templates referencing these images</p></li></ul><p>This chapter describes how you can efficiently perform a release and how to troubleshoot if something goes wrong. This documentation might also be interesting to you even when you do not perform a release on your own, as it might help you to understand how the various Syndesis artifacts fit together.</p><h3 id="usage-5">Usage</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Perform a release

This command performs a release but does no automated rollback when something fails.
Please refer to the manual at https://docs.syndesis.io for more details and what needs
to be cleaned up in case of a failure.

Usage: syndesis release [... options ...]

Options for release:
-n  --dry-run                 Dry run, which performs the whole build but does no tagging,
                              artifact upload or pushing Docker images
    --release-version &lt;ver&gt;   Version to release (e.g. &#34;1.2.1&#34;). This is a mandatory argument.
    --snapshot-release        Snapshot release which can be created on a daily basis.
                              A timestamped version will be created automatically, and no Maven artifacts
                              are pushed to maven central. No moving tag will be moved, too.
    --dev-version &lt;version&gt;   Next development version. If not given, set to
                              &#34;&lt;major&gt;.&lt;minor&gt;-SNAPSHOT&#34; as calculated from
                              --release-version (e.g. &#34;1.2-SNAPSHOT&#34;)
    --settings &lt;file&gt;         Path to a custom settings.xml to use for the release.
                              This file must contain all the credentials to be used for Sonatype.
                              By default ~/.m2/settings.xml is used.
    --local-maven-repo &lt;dir&gt;  Local dir for holding the local Maven repo cache.
                              If not given, then a new
                              temporary directory will be used
                              (and removed after the release)
    --docker-user &lt;user&gt;      Docker user for Docker Hub
    --docker-password &lt;pwd&gt;   Docker password for Docker Hub
    --no-git-push             Don&#39;t push the release tag (and symbolic major.minor tag)
    --git-remote              Name of the git remote to push to. If not given, its trying to be pushed
                              to the git remote to which the currently checked out branch is attached to.
                              Works only when on a branch, not when checked out directly.

    --log &lt;log-file&gt;          Write full log to &lt;log-file&gt;, only print progress to screen
    --man                     Open HTML documentation in the Syndesis Developer Handbook</code></pre></div><p>A lot of output is produced during a release. If you are only interested to see the major steps only, then you can use <code>--log</code> to redirect the output to a specific log file. This log file will contain all output (and if you add <code>--verbose</code> you see even more output), but on the console you will only see the current step that is actually performed.</p><p><strong>Example</strong></p><p>An example run for a dry run for <code>1.3.1</code> release on the current branch look like:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">./tools/bin/syndesis release <span style="color:#d14">\ </span>          <span style="color:#099">1</span>
    --release-version 1.3.1 <span style="color:#d14">\ </span>           <span style="color:#099">2</span>
    --local-maven-repo /tmp/clean-repo <span style="color:#d14">\ </span><span style="color:#099">3</span>
    --log /tmp/build.log <span style="color:#d14">\ </span>              <span style="color:#099">4</span>
    --dry-run                            <span style="color:#099">5</span></code></pre></div><ol><li><p>Always run <code>syndesis</code> from the repo and branch you want to release.</p></li><li><p>The release version is mandatory and must be in the format <code>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</code>.</p></li><li><p>Use a clean local Maven repository to avoid side effects</p></li><li><p>Redirect the full output to <code>/tmp/build.log</code> but still print the main steps to the console.</p></li><li><p>Make only a dry run, without pushing any artifacts out nor checking in any changed files.</p></li></ol><h3 id="preparations">Preparations</h3><p>To perform a release, certain preconditions need to be given.</p><p>First of all, you need to have access to the various systems to which release artifacts are uploaded:</p><ul><li><p>You need to be logged in to <a href="https://hub.docker.com/" rel="noreferrer" target="_blank">Docker Hub</a> and your account needs to have write access to the <a href="https://hub.docker.com/u/syndesis/" rel="noreferrer" target="_blank">syndesis</a> Docker Hub organisation.</p></li><li><p>You have <code>gpg</code> to have installed and set up a gpg-agent for being able to sign Maven artifacts during deployment in a non-interactive mode.</p></li><li><p>You need to have access to the &ldquo;syndesis&rdquo; account on (<a href="https://oss.sonatype.org/" rel="noreferrer" target="_blank">oss.sonatype.org</a> for being able to publish Maven artifacts. This credential needs to be added to either your <code>~/.m2/settings.xml</code> or you can use an settings file with the <code>--settings-xml</code> option. The credential needs to be added to the server with the id <code>oss-sonatype-staging</code>.</p></li></ul><p>You have to perform the release from a locally checked out Syndesis repository, which can be either checkout from a branch like <code>1.2.x</code> for a patch release or directly from <code>master</code>. It is highly recommended to run the release directly from a freshly checked out directory:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#998;font-style:italic"># Go to a temporary directory</span>
<span style="color:#0086b3">cd</span> /tmp

<span style="color:#998;font-style:italic"># Clone repository afresh, but only use the last history entry (--depth=1)</span>
git clone --depth<span style="color:#000;font-weight:700">=</span><span style="color:#099">1</span> https://github.com/syndesisio/syndesis.git

<span style="color:#998;font-style:italic"># Jump into the directory</span>
<span style="color:#0086b3">cd</span> syndesis

<span style="color:#998;font-style:italic"># Switch to the target branch if needed (or stay on master)</span>
git fetch --depth <span style="color:#099">1</span> origin 1.2.x:1.2.x
git checkout 1.2.x

<span style="color:#998;font-style:italic"># Call Syndesis from the checked out clone</span>
./tools/bin/syndesis release --release-version 1.2.8 .....

<span style="color:#998;font-style:italic"># Push to origin after a successful release.</span>
<span style="color:#998;font-style:italic"># This automatically done if --no-git-push is given</span>
git push 1.2.8
git push -f 1.2

<span style="color:#998;font-style:italic"># Remove the temporary clone again</span>
<span style="color:#0086b3">cd</span> ..
rm -rf syndesis</code></pre></div><p>Please note that you should always call <code>syndesis</code> out of the branch for which the release is for. If there is an issue due to bugs in the release script itself, please fix them on the branch with the usual developer process (i.e. opening a PR request). <code>syndesis release</code> must always work for the branch where this script is, too.</p><h3 id="release-steps">Release steps</h3><p>A release consist of several different steps, which can be grouped into two groups:</p><ul><li><p><strong>Build steps</strong> are performed to build the release and create the artifacts. Also during the build Maven artifacts are uploaded to the staging area for publishing to Maven central</p></li><li><p><strong>Persist steps</strong> are then used for releasing objects, pushing Docker images to Docker Hub, committing and tagging in Git (but only when the build steps have been performed successfully).</p></li></ul><p><strong>Build steps</strong></p><ul><li><p>Check whether the current local Git clone is <em>clean</em>, i.e. that is does not have any modified files. The script will abort if this is the case.</p></li><li><p>Update the versions of all <code>pom.xml</code> files below <code>app/</code> to the version given with <code>--release-version</code>. If no <code>--release-version</code> is given, then the script aborts.</p></li><li><p>Run an <code>mvn clean install</code> to verify that the build is not broken and all tests succeed.</p></li><li><p>Re-generate the OpenShift templates in <code>install</code> so that the image streams included in these templates refer to Docker images with the new version.</p></li><li><p>Now run an <code>mvn -Prelease clean deploy</code> to deploy all artifacts to a new staging repository on oss.sonatype.org, the platform for release artifacts on Maven central. The staging repository on this Sonatype Nexus is validated and closed.</p></li><li><p>If <code>--docker-user</code> and <code>--docker-password</code> is given, then a <code>docker login</code> is performed. Otherwise, it is assumed that the user is already logged in.</p></li><li><p>The Docker images are created with <code>mvn -Prelease,image package</code> in the <code>server</code>, <code>meta</code>, <code>ui</code> and <code>s2i</code> modules.</p></li></ul><p>If the option <code>--dry-run</code> (short: <code>-n</code>) is provided, the script drops the staging repository at Sonatype and stops. You should examine the generated files and before starting a real build, reset the repository (<code>git reset --hard</code>).</p><p>The builds are using a clean local Maven repository, which otherwise is usually taken from <code>~/.m2/repository</code>. This new local cache should ensure that we have a completely fresh build without interference from previous builds store in the local Maven cache in the home directory. You can provide such a directory with <code>--local-maven-repo</code> which will be taken directly (so it’s good if you have to perform multiple runs like with <code>--dry-run</code>). If not provided, a new temporary directory is created and also <em>deleted</em> after the release run.</p><p><strong>Persist Steps</strong></p><ul><li><p>Push Docker images to Docker Hub. In addition to the images that carry the full release version as the tag, also a tag for the <em>minor version</em> is attached and pushed. E.g. when the release version is <code>1.2.8</code>, then the minor version is <code>1.2</code>. If this minor version tag already exists on Docker Hub, its moved to the newly created version.</p></li><li><p>The staging repository on Sonatype is released. It will take a bit, but the artifact should then be downloadable from <a href="https://search.maven.org/" rel="noreferrer" target="_blank">Maven central</a> soon after.</p></li><li><p>Commit all modified local files to the local Git repo.</p></li><li><p>Create a Git tag for the release version (e.g. <code>git tag 1.2.8</code>).</p></li></ul><p>The next steps are for creating templates for the minor version:</p><ul><li><p>In <code>install</code> create new templates which contain image streams that reference images with the minor version (e.g. <code>syndesis/syndesis-server:1.3</code> for a release version of 1.3.8).</p></li><li><p>Commit those generated templates</p></li><li><p>Tag it with the minor version (e.g. <code>1.2</code>), overwriting an already existing minor version tag</p></li></ul><p>Next, we are switching back to the next development version of the pom.xml files. This version can be given with <code>--dev-version</code>, but by default, it is calculated automatically as <code>&lt;minor.version&gt;-SNAPSHOT</code> (e.g. <code>1.2-SNAPSHOT</code>). This new version is then committed to the local git repository.</p><p>Finally, the tags just created on the local Git repo is pushed to the remote repository. You can omit this with the option <code>--no-git-push</code>. If to so, the last step can also be performed manually afterwards with:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git push 1.2.8   
git push -f 1.2   <span style="color:#099">1</span></code></pre></div><ol><li>Using <code>-f</code> as the minor tag needs to be moved.</li></ol><p>Please be careful to <strong>not</strong> push the master branch upstream (i.e. do <strong>not</strong> a plain <code>git push</code>). We only want to have the tag with all the release preparation steps, not on the branch so that pull requests can be still be easily rebased with out conflict because of the temporary version changes.</p><h3 id="minor-version-templates">Minor Version Templates</h3><p>What is now the thing with this <em>minor version</em>? Why is the needed and how does it work?</p><p>Syndesis follows a <a href="https://semver.org/" rel="noreferrer" target="_blank">semantic versioning</a> approach. So, patch level releases (i.e. all releases which only change the last digit in 1.2.8) are fully compatible with all other patch level versions. In order to allow easy bug fix upgrades, we also create a tag which contains only the version parts up to the minor version (e.g. 1.2). These tags <strong>always</strong> points to the latest full version of its minor version. If, e.g. 1.2.8 is the latest 1.2.x version, then the tag 1.2 point to this 1.2.8 version. Corresponding to these Docker image variants, there exist two OpenShift templates variants:</p><ul><li><p>One set of templates directly references the Docker images which its full version, e.g. <code>syndesis/syndesis-ui:1.2.8</code>. Applying such a template will keep your application at precisely this patch-level. You would have to update your templates and recreate your applications if you want to upgrade.</p></li><li><p>The other set of templates references images only via its minor version, e.g. <code>syndesis/syndesis-ui:1.2</code>. Using these templates has the advantage that application created from these templates automatically benefit from patch releases. The templates contain an image change trigger which will redeploy the application if the images change. So when we release the next patch level release, moving the minor version tag to this patch level release, then the application gets automatically redeployed, and it will pick up the new image.</p></li></ul><p>These two sets of templates can be reached directly from GitHub as the git tags correspond to the Docker tags (i.e. a <code>1.2.8</code> tag and a <code>1.2</code> tag which will be moved forward).</p><h3 id="snapshot-release">Snapshot Release</h3><p>With the option <code>--snapshot-release</code> a lightweight snapshot release for the images and templates can be created. The tag/version is calculated automatically by picking up the latest release number (e.g. 1.3.5), increasing the patch-level by one and adding a daily timestamp (e.g. 1.3.6-20180419). According to <a href="https://semver.org/" rel="noreferrer" target="_blank">Semantic Versioning 2.0</a> this is considered to be a version larger than 1.3.5 but <a href="https://semver.org/#spec-item-11" rel="noreferrer" target="_blank">smaller</a> than 1.3.6.</p><p>This tag can be referenced to in <code>syndesis install</code> and <code>syndesis minishift</code>.</p><p>In detail, a snapshot release differs from a normal release as it:</p><ul><li><p>…​ doesn’t release artifacts on Maven central, but pushes Docker images and creates a Git tag for referencing the proper templates.</p></li><li><p>…​ skips all checks and tests when building to maximise the likelihood that the release succeeds. The rationale here is to better have untested daily snapshot release than no snapshot release because of test failure (which in many cases are not because of errors, but of failure in the infrastructure)</p></li><li><p>…​ force pushes the snapshot tag on GitHub so that multiple releases per day are allowed</p></li></ul><p><strong>Example</strong></p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">syndesis release <span style="color:#d14">\
</span><span style="color:#d14"></span>     --snapshot-release <span style="color:#d14">\ </span>                  <span style="color:#099">1</span>
     --local-maven-repo /tmp/clean-repo <span style="color:#d14">\ </span>  <span style="color:#099">2</span>
     --git-remote origin <span style="color:#d14">\ </span>                 <span style="color:#099">3</span>
     --docker-user <span style="color:#d14">&#34;</span><span style="color:#d14">${</span><span style="color:teal">DOCKER_USER</span><span style="color:#d14">}</span><span style="color:#d14">&#34;</span> <span style="color:#d14">\ </span>      <span style="color:#099">4</span>
     --docker-password <span style="color:#d14">&#34;</span><span style="color:#d14">${</span><span style="color:teal">DOCKER_PASSWORD</span><span style="color:#d14">}</span><span style="color:#d14">&#34;</span></code></pre></div><ol><li><p>Enable snapshot release with a version in the format 1.3.5-20180419</p></li><li><p>Point to an empty repository to avoid side effects when building</p></li><li><p>Push to the origin repository</p></li><li><p>Docker credentials required for pushing to Docker Hub</p></li></ol><p>A daily Jenkins job with this configuration run on <a href="https://ci.fabric8.io" rel="noreferrer" target="_blank">https://ci.fabric8.io</a> for creating a daily snapshots.</p><h3 id="troubleshooting">Troubleshooting</h3><p>When you run the <code>syndesis release</code> command and when it should not succeed, you might have to perform some cleanup steps yourself (there is now automatic rollback). However, care has been taken to move all persistent changes to the end of the release flow, so if something breaks early, you only need to clean up locally. If the process fails before the step <em>=== Pushing Docker images</em> you only need to:</p><ul><li><p>Reset your local git repo with <code>git reset --hard</code></p></li><li><p>Potentially remove the create staging repository on <code>http://oss.sonatype.org/</code> (but it doesn’t harm if it is not cleaned up immediately).</p></li></ul><p>After pushing the Docker images, it should be improbable that things go wrong. But these things should take care of if this should be the case:</p><ul><li><p>Remove Docker Hub tags for the pushed images, which is best done on the Docker Hub Web UI</p></li><li><p>Revert your local git commits to the point before the release. If you did this on a fresh checked out repo (as recommended), you just could delete the whole clone.</p></li></ul><h2 id="syndesis-install">syndesis install</h2><p>With <code>syndesis install</code> you can install Syndesis to an arbitrary OpenShift cluster. If you want to install to <a href="https://www.openshift.org/minishift/" rel="noreferrer" target="_blank">Minishift</a> the <a href="#syndesis-minishift">syndesis minishift</a> command is recommended as it supports some additional features specific to Minishift.</p><h3 id="usage-6">Usage</h3><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">-s  --setup               Install CRDs clusterwide. Use --grant if you want a specific user to be
                          able to install Syndesis. You have to run this option once as
                          cluster admin.
-u  --grant &lt;user&gt;        Add permissions for the given user so that user can install
                          the operator in her projects. Must be run as cluster admin.
    --cluster             Add the permission for all projects in the cluster
                          (only when used together with --grant)
-p  --project             Install into this project. Delete this project
                          if it already exists. By default, install into the current project
                          (without deleting)
    --operator-only       Only install the operator but no resource
    --route               Route to use. If not given, the route is trying to be detected
                          from the currently connected cluster.
    --console             The URL to the OpenShift console
    --tag &lt;tag&gt;           Syndesis version/tag to install. If not given, then the latest
                          version from master is installed
    --dev                 Prepare for development of Syndesis so that S2I builds of
                          Syndesis images are picked up properly (implies --watch)
    --force               Override an existing &#34;Syndesis&#34; if present
-w  --watch               Wait until cluster is up
    --local               install from local Git repo when using. By default the
                          resource descriptor is downloaded from GitHub remotely.
-o  --open                Open Syndesis in browser when installation is ready (implies --watch)
-y  --yes                 Assume &#39;yes&#39; automatically when asking for deleting
                          a given project.
    --memory-server &lt;mem&gt; Memory limit to set for syndesis-server. Specify as &#34;800Mi&#34;
    --memory-meta &lt;mem&gt;   Memory limit to set for syndesis-meta. Specify as &#34;512Mi&#34;
    --test-support        Allow test support endpoint for syndesis-server

You have to run --setup --grant &lt;user&gt; as a cluster-admin before you can
install Fuse Online as a user.</code></pre></div><p>The deployment happens to the currently connected OpenShift cluster. So it’s mandatory that you have logged into the cluster with <code>oc login</code> before. You can check the status with <code>oc status</code>.</p><p>The installation process consists of two steps:</p><ul><li><p>An initial setup which has to be performed as <em>cluster admin</em> which is a one-off action which needs to be done only once.</p></li><li><p>Installation of Syndesis into a specific project by the <em>app admin</em>, a regular user of OpenShiftm which can be performed as many times as required.</p></li></ul><h3 id="initial-setup">Initial Setup</h3><p>In the initial setup, you have to register the custom resource definition (CRD) to allow to deploy <code>Syndesis</code> resources. This step has to be performed by the admin.</p><p>Also, if you want to allow an OpenShift user to install Syndesis on her own, then you have to grant specific permissions to her.</p><p>To perform this setup step, which needs to be performed only once per cluster, you have to run <code>syndesis</code> <strong>while being connected as a cluster admin</strong>. For <code>minishift</code> use <code>oc login -u system:admin</code> if you have the <code>admin-user</code> addon enabled.</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">syndesis install --setup</code></pre></div><p>This will install only the CRD. In addition to grant a user <em>developer</em> the proper permission to create a <code>Syndesis</code> resource, you should add <code>--grant &lt;user&gt;</code>:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">syndesis install --setup --grant &lt;user&gt;</code></pre></div><p>This call adds permissions to read and write <code>Syndesis</code> resource objects for the current project. If you would instead want to allow the user managing <code>Syndesis</code> resources in the whole cluster, you should add a <code>--cluster</code>. This cluster-wide access is especially required when you plan to use the <code>--project</code> option to use a new project or recreate the existing one, as in this case the role association to this project gets lost.</p><h3 id="installing-syndesis-1">Installing Syndesis</h3><p>After the CRDs a registered, you can easily install Syndesis directly with</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">syndesis install</code></pre></div><p>Depending on whether you have granted the current user access this step has to be done either as admin or as a regular user.</p><p><strong>Example for Minishift</strong></p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#998;font-style:italic"># Enable the admin user on Minishift</span>
minishift addons <span style="color:#0086b3">enable</span> admin-user

<span style="color:#998;font-style:italic"># Create a minishift instance</span>
minishift start --memory <span style="color:#099">4192</span>

<span style="color:#998;font-style:italic"># Switch to admin</span>
oc login -u system:admin

<span style="color:#998;font-style:italic"># Register CRD and grant permissions to &#34;developer&#34;</span>
syndesis install --setup --grant developer --cluster

<span style="color:#998;font-style:italic"># Switch to account developer</span>
oc login -u developer

<span style="color:#998;font-style:italic"># Install Syndesis</span>
syndesis install</code></pre></div><p>A route name can be given with <code>--route</code>. This step can be omitted as the operator can autodetect the route. If you provide the route manually, you need to check your OpenShift installation. Typically the route name is the name of your OpenShift project followed by the cluster’s hostname. E.g. a route <code>--route proj186023.6a63.fuse-ignite.openshiftapps.com</code> is specific to the Fuse Ignite test cluster <code>6a63.fuse-ignite.openshiftapps.com</code> and for the project <code>proj186023</code>. However, you don’t have to provide the route name.</p><p>If you want to have a link to the OpenShift console to read the Pod logs, you have to add the <code>--console</code> option with the full URL to the console. Unfortunately, this cannot be autodetected. If not given, no link appears.</p><p>By default, this commands installs Syndesis in the currently connected project, but you can specify an alternative project with <code>--project &lt;project&gt;</code>. If this project already exists, it gets deleted unconditionally before the deployment, so be careful when using this option. By default, you are asked whether you want to delete the project for recreation. You can switch off the security question with the option <code>--yes</code> (short: <code>-y</code>).</p><div class="alert alert-info admonition" role="alert"><i class="fa warning"></i> Don’t use `syndesis install --project $(oc project -q) --yes`. You’ll shoot yourself into the foot. Ask the author if you want to know more details.</div><p>If you want to wait until everything is running (including fetching of the Docker images), you can specify <code>--watch</code> (short: <code>-w</code>) which blocks the script until everything is set up.</p><p>You can also automatically open Syndesis in the browser after the installation with <code>--open</code> (short: <code>-o</code>)</p><h3 id="development-mode">Development Mode</h3><p>As with <a href="#syndesis-minishift">syndesis minishift</a> you can also use this command to set up a development platform for Syndesis. <em>Development platform</em> here means that you can create Docker images on your own with <a href="#syndesis-build">syndesis build</a> and can use them with an automatic redeployment after the build.</p><p>You can switch on this mode with the option <code>--dev</code>. When the operator has deployed the application, the application imagestreams refer to Docker images pushed to Docker Hub. To change the imagestream references to the images built with <code>syndesis build --all-images</code>, these imagestreams needs to be patched after the initial images have been fetched from Docker Hub. If you use the <code>--dev</code> option, then this update is done automatically.</p><h3 id="selecting-the-version">Selecting the Version</h3><p>With the option <code>--tag</code> you can select a specific version of Syndesis to install. By default, the currently checked out checked out branch is used.</p><p><strong>Example</strong></p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">syndesis install --route syndesis.192.168.64.12.nip.io --tag 1.4</code></pre></div><p>This example installs the latest Syndesis version of the 1.4 branch to the local cluster.</p><p>You can see a list of available tags with <code>git tag</code>. Tags prefixed with <code>fuse-ignite</code> are suited for the Fuse Online cluster as those templates do not contain images streams themselves but refer to the image streams installed on this cluster.</p><h3 id="quick-installation">Quick Installation</h3><div class="alert alert-info admonition" role="alert"><i class="fa warning"></i> The following scripts are not yet updated and probably don’t work as expected. Please stay tuned.</div><p>If you only want to install Syndesis without developing for, there is even an easier without checking out Syndesis into a local Git repository.</p><p>You can directly use the standalone installation script <a href="https://raw.githubusercontent.com/syndesisio/syndesis/master/tools/bin/install-syndesis" rel="noreferrer" target="_blank">syndesis-install</a> for installing Syndesis. Just download this <a href="https://raw.githubusercontent.com/syndesisio/syndesis/master/tools/bin/install-syndesis" rel="noreferrer" target="_blank">script</a>, save it as &ldquo;syndesis-install&rdquo; and then call it with</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bash install-syndesis --route <span style="color:#000;font-weight:700">$(</span>oc project -q<span style="color:#000;font-weight:700">)</span>.6a63.fuse-ignite.openshiftapps.com --open</code></pre></div><p>Or, if you feel fancy (and trust us), then you can directly install the latest version of Syndesis by deleting and recreating the current project with a single line:</p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bash &lt;<span style="color:#000;font-weight:700">(</span>curl -sL https://bit.ly/syndesis-install<span style="color:#000;font-weight:700">)</span> -p <span style="color:#000;font-weight:700">$(</span>oc project -q<span style="color:#000;font-weight:700">)</span> -r <span style="color:#000;font-weight:700">$(</span>oc project -q<span style="color:#000;font-weight:700">)</span>.6a63.fuse-ignite.openshiftapps.com -o</code></pre></div><p>All you need is to have <code>bash</code>, <code>curl</code> and <code>oc</code> installed and you need to be connected to an OpenShift cluster.</p><p>Use <code>install-syndesis --help</code> for a list of options (which is a subset of <code>syndesis install</code> described above).</p></div></div></div><div class="toc hidden-md-down"><nav id="TableOfContents"><ul><li><ul><li><a href="#buildtool-syndesis">Buildtool &ldquo;syndesis&rdquo;</a><ul><li><a href="#usage-message">Usage Message</a></li><li><a href="#rebase-to-upstream">Rebase to Upstream</a></li><li><a href="#development-modes">Development Modes</a></li><li><a href="#commands">Commands</a></li></ul></li><li><a href="#syndesis-build">syndesis build</a><ul><li><a href="#usage">Usage</a></li><li><a href="#modules">Modules</a></li><li><a href="#tuning">Tuning</a></li><li><a href="#infrastructure-operator">Infrastructure Operator</a></li><li><a href="#examples">Examples</a></li></ul></li><li><a href="#syndesis-ui">syndesis ui</a></li><li><a href="#syndesis-minishift">syndesis minishift</a><ul><li><a href="#usage-1">Usage</a></li><li><a href="#installing-syndesis">Installing Syndesis</a></li><li><a href="#resetting-minishift">Resetting Minishift</a></li><li><a href="#example">Example</a></li></ul></li><li><a href="#syndesis-system-test">syndesis system-test</a><ul><li><a href="#usage-2">Usage</a></li><li><a href="#how-it-works">How it works</a></li></ul></li><li><a href="#syndesis-dev">syndesis dev</a><ul><li><a href="#usage-3">Usage</a></li></ul></li><li><a href="#syndesis-doc">syndesis doc</a><ul><li><a href="#usage-4">Usage</a></li><li><a href="#output">Output</a></li></ul></li><li><a href="#syndesis-release">syndesis release</a><ul><li><a href="#usage-5">Usage</a></li><li><a href="#preparations">Preparations</a></li><li><a href="#release-steps">Release steps</a></li><li><a href="#minor-version-templates">Minor Version Templates</a></li><li><a href="#snapshot-release">Snapshot Release</a></li><li><a href="#troubleshooting">Troubleshooting</a></li></ul></li><li><a href="#syndesis-install">syndesis install</a><ul><li><a href="#usage-6">Usage</a></li><li><a href="#initial-setup">Initial Setup</a></li><li><a href="#installing-syndesis-1">Installing Syndesis</a></li><li><a href="#development-mode">Development Mode</a></li><li><a href="#selecting-the-version">Selecting the Version</a></li><li><a href="#quick-installation">Quick Installation</a></li></ul></li></ul></li></ul></nav></div></div><footer class="page-footer text-center"><div class="row"><section class="col-md-6"><i class="fa fa-3x fa-github" aria-hidden="true"></i><h4>Get the source code</h4><p>Stay tuned to contribute or build your own solution.</p><p class="link-button"><a href="https://github.com/syndesisio" rel="nofollow" target="_blank" class="btn btn-primary">Syndesis on GitHub</a></p></section><section class="col-md-6"><i class="fa fa-3x fa-comments-o"></i><h4>Connect with us</h4><p>Chat with the Syndesis community.</p><p class="link-button"><a href="https://gitter.im/syndesisio/community" rel="nofollow" target="_blank" class="btn btn-primary">syndesisio on Gitter</a></p></section></div><div class="rh-logo"><section><a href="https://www.redhat.com" rel="nofollow" title="Red Hat, Inc." target="_blank"><img width="128" height="42" src="https://syndesis.io/images/redhatnew.svg" alt="Red Hat, Inc."></a></section></div></footer></div><script src="https://syndesis.io/js/syndesis.js"></script></body></html>